# üìã –ö–†–ê–¢–ö–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø: –ú–∏–≥—Ä–∞—Ü–∏—è –≤ Supabase

## üéØ –§–ê–ô–õ–´ –î–õ–Ø –ú–ò–ì–†–ê–¶–ò–ò:

### 1Ô∏è‚É£ **`step1_schema_create.sql`**
   - –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î (—Ç–∞–±–ª–∏—Ü–∞, –∏–Ω–¥–µ–∫—Å—ã, constraints, views)
   - –í—ã–ø–æ–ª–Ω–∏—Ç–µ **–ü–ï–†–í–´–ú** –≤ SQL Editor Supabase

### 2Ô∏è‚É£ **`step2_run_migration_SUPABASE.sql`** ‚≠ê
   - –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV –≤ —Ç–∞–±–ª–∏—Ü—É `care_homes`
   - –í—ã–ø–æ–ª–Ω–∏—Ç–µ **–í–¢–û–†–´–ú** –≤ SQL Editor Supabase
   - **–ê–î–ê–ü–¢–ò–†–û–í–ê–ù–û** –¥–ª—è Supabase (–±–µ–∑ \copy)

---

## üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢:

### –®–ê–ì 1: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã
1. –û—Ç–∫—Ä–æ–π—Ç–µ **Supabase Dashboard** ‚Üí **SQL Editor**
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `step1_schema_create.sql`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **–≤–µ—Å—å —Ñ–∞–π–ª** –≤ SQL Editor
4. –ù–∞–∂–º–∏—Ç–µ **Run** (`Cmd+Enter`)
5. ‚úÖ –ì–æ—Ç–æ–≤–æ! –¢–∞–±–ª–∏—Ü–∞ `care_homes` —Å–æ–∑–¥–∞–Ω–∞

### –®–ê–ì 2: –ó–∞–≥—Ä—É–∑–∫–∞ CSV —á–µ—Ä–µ–∑ Table Editor
1. –í Supabase Dashboard ‚Üí **Table Editor**
2. –ù–∞–∂–º–∏—Ç–µ **New Table**
3. –ù–∞–∑–≤–∞–Ω–∏–µ: `temp_cqc_raw`
4. **–ù–ï —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –∫–æ–ª–æ–Ω–∫–∏!** –ù–∞–∂–º–∏—Ç–µ **Import data** ‚Üí **Import CSV**
5. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª `CQC-DataSet_rows.csv`
6. Supabase –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –∫–æ–ª–æ–Ω–∫–∏
7. ‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã

### –®–ê–ì 3: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `step2_run_migration_SUPABASE.sql`
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **–≤–µ—Å—å —Ñ–∞–π–ª** –≤ SQL Editor Supabase
3. –ù–∞–∂–º–∏—Ç–µ **Run** (`Cmd+Enter`)
4. ‚úÖ –î–∞–Ω–Ω—ã–µ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `care_homes`

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê:

```sql
-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
SELECT COUNT(*) FROM care_homes;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: ~271

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏—Ü–µ–Ω–∑–∏–π
SELECT 
    COUNT(*) FILTER (WHERE has_nursing_care_license = TRUE) as nursing_license,
    ROUND(100.0 * COUNT(*) FILTER (WHERE has_nursing_care_license = TRUE) / COUNT(*), 1) as pct
FROM care_homes;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: ~73% —Å nursing license

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ Views
SELECT * FROM v_data_coverage LIMIT 10;
SELECT * FROM v_service_user_bands_coverage;
```

---

## üìù –í–ê–ñ–ù–û:

- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –∏ Views **—É–∂–µ —Å–æ–∑–¥–∞–Ω—ã** –≤ `step1_schema_create.sql`
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏—Ö –ø–æ–≤—Ç–æ—Ä–Ω–æ
- ‚úÖ –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ –ø—É—Å—Ç–∞, —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç TRUNCATE
- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

**–ì–æ—Ç–æ–≤–æ!** üéâ


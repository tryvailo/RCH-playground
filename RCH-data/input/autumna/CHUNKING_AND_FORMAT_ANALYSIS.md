# üìä –ê–ù–ê–õ–ò–ó: –ß–ê–ù–ö–ò–ù–ì –ò HTML vs MARKDOWN

**–î–∞—Ç–∞:** 3 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** v2.4  
**–°—Ç–∞—Ç—É—Å:** –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## üîç –í–û–ü–†–û–° 1: –ò–¥–µ—Ç –ª–∏ —Ä–∞–∑–±–∏—Ç–∏–µ HTML —Ñ–∞–π–ª–∞ –Ω–∞ —á–∞–Ω–∫–∏ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ?

### ‚ùå –û–¢–í–ï–¢: –ù–ï–¢, —á–∞–Ω–∫–∏–Ω–≥ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

–í `phase2_parse_llm.py` –≤–µ—Å—å HTML –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è **—Ü–µ–ª–∏–∫–æ–º** –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –∫ OpenAI API:

```python
def parse_html_with_openai(client: OpenAI, html_content: str, system_prompt: str, response_format: dict) -> Dict:
    """–ü–∞—Ä—Å–∏–Ω–≥ HTML —á–µ—Ä–µ–∑ OpenAI API"""
    response = client.chat.completions.create(
        model=OPENAI_MODEL,
        messages=[
            {"role": "system", "content": system_prompt},
            {"role": "user", "content": f"Parse this HTML page:\n\n{html_content}"}  # ‚Üê –í–µ—Å—å HTML —Ü–µ–ª–∏–∫–æ–º
        ],
        response_format={"type": "json_schema", "json_schema": response_format['json_schema']},
        temperature=0
    )
```

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
   - GPT-4o –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç ~128K —Ç–æ–∫–µ–Ω–æ–≤
   - –ë–æ–ª—å—à–∏–µ HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã –º–æ–≥—É—Ç –Ω–µ –ø–æ–º–µ—Å—Ç–∏—Ç—å—Å—è
   - –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã Autumna: ~100-500 KB

2. **–°—Ç–æ–∏–º–æ—Å—Ç—å:**
   - –ë–æ–ª—å—à–µ —Ç–æ–∫–µ–Ω–æ–≤ = –≤—ã—à–µ —Ü–µ–Ω–∞
   - HTML —Å–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–≥–æ "—à—É–º–∞" (—Å—Ç–∏–ª–∏, —Å–∫—Ä–∏–ø—Ç—ã, —Ä–∞–∑–º–µ—Ç–∫–∞)

3. **–ö–∞—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Å–∏–Ω–≥–∞:**
   - –ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç —Ö—É–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
   - –í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –º–æ–∂–µ—Ç "–ø–æ—Ç–µ—Ä—è—Ç—å—Å—è" –≤ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ —Ç–µ–∫—Å—Ç–∞

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

#### ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Markdown –≤–º–µ—Å—Ç–æ HTML (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

Firecrawl –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å markdown, –∫–æ—Ç–æ—Ä—ã–π:
- **–ù–∞ 30-50% –º–µ–Ω—å—à–µ —Ç–æ–∫–µ–Ω–æ–≤** (—É–±–∏—Ä–∞–µ—Ç —Å—Ç–∏–ª–∏, —Å–∫—Ä–∏–ø—Ç—ã, —Ä–∞–∑–º–µ—Ç–∫—É)
- **–õ—É—á—à–µ —á–∏—Ç–∞–µ—Ç—Å—è LLM** (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç)
- **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É** (–∑–∞–≥–æ–ª–æ–≤–∫–∏, —Å–ø–∏—Å–∫–∏, —Ç–∞–±–ª–∏—Ü—ã)

#### ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 2: –î–æ–±–∞–≤–∏—Ç—å —É–º–Ω—ã–π —á–∞–Ω–∫–∏–Ω–≥ (–µ—Å–ª–∏ HTML –≤—Å–µ –µ—â–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π)

–ï—Å–ª–∏ –¥–∞–∂–µ Markdown —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π, –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –Ω–∞ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —Å–µ–∫—Ü–∏–∏:
- –°–µ–∫—Ü–∏—è 1: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã
- –°–µ–∫—Ü–∏—è 2: –õ–æ–∫–∞—Ü–∏—è –∏ –∞–¥—Ä–µ—Å
- –°–µ–∫—Ü–∏—è 3: –¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
- –°–µ–∫—Ü–∏—è 4: –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –ò —Ç.–¥.

–ó–∞—Ç–µ–º –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–∂–¥–æ–π —Å–µ–∫—Ü–∏–∏.

---

## üîç –í–û–ü–†–û–° 2: –ß—Ç–æ –ª—É—á—à–µ –ø–∞—Ä—Å–∏—Ç—å - HTML –∏–ª–∏ MD —Ñ–æ—Ä–º–∞—Ç?

### ‚úÖ –û–¢–í–ï–¢: **MARKDOWN –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ**

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:

1. **Firecrawl –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å markdown:**
   - –í `phase1_load_html.py` —Å—Ç—Ä–æ–∫–∞ 149: `content = item.get('content') or item.get('html') or item.get('markdown', '')`
   - –ù–æ –∫–æ–¥ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç HTML: `"format": "html"` (—Å—Ç—Ä–æ–∫–∞ 103)

2. **–í –ø–∞–ø–∫–µ `Data-MD` –µ—Å—Ç—å –ø—Ä–∏–º–µ—Ä—ã MD —Ñ–∞–π–ª–æ–≤:**
   - –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–µ –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç markdown –≤–µ—Ä—Å–∏—è

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Markdown:

#### 1. üí∞ –≠–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤ (30-50%)

**HTML –ø—Ä–∏–º–µ—Ä:**
```html
<div class="col-md-8">
    <h2 class="care-home-title">Treetops Court Care Home</h2>
    <p class="address-text">Park Road, Leek, Staffordshire ST13 8XP</p>
</div>
```

**Markdown —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç:**
```markdown
# Treetops Court Care Home

Park Road, Leek, Staffordshire ST13 8XP
```

**–≠–∫–æ–Ω–æ–º–∏—è:** ~60% —Ç–æ–∫–µ–Ω–æ–≤ —Ç–æ–ª—å–∫–æ –Ω–∞ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ!

#### 2. üéØ –õ—É—á—à–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –¥–ª—è LLM

- Markdown —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É (–∑–∞–≥–æ–ª–æ–≤–∫–∏, —Å–ø–∏—Å–∫–∏, —Ç–∞–±–ª–∏—Ü—ã)
- –£–±–∏—Ä–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–π —à—É–º (—Å—Ç–∏–ª–∏, –∫–ª–∞—Å—Å—ã, –∞—Ç—Ä–∏–±—É—Ç—ã)
- –§–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ **–∫–æ–Ω—Ç–µ–Ω—Ç–µ**, –∞ –Ω–µ –Ω–∞ —Ä–∞–∑–º–µ—Ç–∫–µ

#### 3. üìä –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

- –ó–∞–≥–æ–ª–æ–≤–∫–∏ (`#`, `##`) ‚Üí —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –°–ø–∏—Å–∫–∏ (`-`, `*`) ‚Üí –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è —É—Å–ª—É–≥, —É–¥–æ–±—Å—Ç–≤
- –¢–∞–±–ª–∏—Ü—ã (`|`) ‚Üí —Ü–µ–Ω—ã, —Ä–µ–π—Ç–∏–Ω–≥–∏
- –°—Å—ã–ª–∫–∏ (`[text](url)`) ‚Üí –∫–æ–Ω—Ç–∞–∫—Ç—ã, —Å–∞–π—Ç—ã

#### 4. üßπ –ú–µ–Ω—å—à–µ —à—É–º–∞

HTML —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –†–µ–∫–ª–∞–º—É –∏ –±–∞–Ω–Ω–µ—Ä—ã
- –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–µ–Ω—é
- –§—É—Ç–µ—Ä—ã –∏ –∫–æ–ø–∏—Ä–∞–π—Ç—ã
- JavaScript –∫–æ–¥
- CSS —Å—Ç–∏–ª–∏

Markdown —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ **—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç**.

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤:

| –§–æ—Ä–º–∞—Ç | –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã | –¢–æ–∫–µ–Ω–æ–≤ (–ø—Ä–∏–º–µ—Ä–Ω–æ) | –°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ 300 —Å—Ç—Ä–∞–Ω–∏—Ü |
|--------|------------------------|-------------------|-------------------------|
| HTML   | 200-500 KB            | 50,000-125,000    | $1.50-3.75              |
| Markdown | 50-150 KB          | 12,500-37,500     | $0.38-1.12              |

**–≠–∫–æ–Ω–æ–º–∏—è:** ~70% —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Markdown!

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é:

#### –®–∞–≥ 1: –ò–∑–º–µ–Ω–∏—Ç—å `phase1_load_html.py`

```python
# –ë—ã–ª–æ:
payload = {
    "urls": batch,
    "format": "html"  # ‚Üê –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ "markdown"
}

# –°—Ç–∞–ª–æ:
payload = {
    "urls": batch,
    "format": "markdown"  # ‚Üê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å markdown
}
```

#### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç—å `phase2_parse_llm.py`

```python
# –ë—ã–ª–æ:
{"role": "user", "content": f"Parse this HTML page:\n\n{html_content}"}

# –°—Ç–∞–ª–æ:
{"role": "user", "content": f"Parse this markdown page:\n\n{markdown_content}"}
```

–ò–ª–∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ:
```python
{"role": "user", "content": f"Parse this page content:\n\n{content}"}
```

#### –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–º–ø—Ç

–í `AUTUMNA_PARSING_PROMPT_v2_4.md` –∏–∑–º–µ–Ω–∏—Ç—å:
- "You are a precision HTML‚ÜíJSON extractor" ‚Üí "You are a precision Markdown‚ÜíJSON extractor"
- –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö –¥–ª—è markdown —Ñ–æ—Ä–º–∞—Ç–∞

#### –®–∞–≥ 4: –û–±–Ω–æ–≤–∏—Ç—å staging —Ç–∞–±–ª–∏—Ü—É

–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ø–æ–ª–µ `html_content` ‚Üí `page_content` (–∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ `markdown_content`)

---

## üìã –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ Markdown (–í–´–°–û–ö–ò–ô)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –≠–∫–æ–Ω–æ–º–∏—è 70% —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞
- ‚úÖ –õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ú–µ–Ω—å—à–µ –ø—Ä–æ–±–ª–µ–º —Å —Ä–∞–∑–º–µ—Ä–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 1-2 —á–∞—Å–∞

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
1. `input/autumna/staging/phase1_load_html.py` - –∏–∑–º–µ–Ω–∏—Ç—å `format: "html"` ‚Üí `format: "markdown"`
2. `input/autumna/staging/phase2_parse_llm.py` - –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–º–ø—Ç –¥–ª—è markdown
3. `input/autumna/AUTUMNA_PARSING_PROMPT_v2_4.md` - –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –î–æ–±–∞–≤–∏—Ç—å —á–∞–Ω–∫–∏–Ω–≥ (–°–†–ï–î–ù–ò–ô)

**–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ:**
- –ï—Å–ª–∏ –¥–∞–∂–µ markdown —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (>100K —Ç–æ–∫–µ–Ω–æ–≤)
- –ï—Å–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ç—Ä–∞–¥–∞–µ—Ç –Ω–∞ –±–æ–ª—å—à–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö

**–ü–æ–¥—Ö–æ–¥:**
- –†–∞–∑–±–∏–≤–∞—Ç—å –Ω–∞ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —Å–µ–∫—Ü–∏–∏
- –ü–∞—Ä—Å–∏—Ç—å –∫–∞–∂–¥—É—é —Å–µ–∫—Ü–∏—é –æ—Ç–¥–µ–ª—å–Ω–æ
- –û–±—ä–µ–¥–∏–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 4-6 —á–∞—Å–æ–≤

---

## üéØ –†–ï–ó–Æ–ú–ï

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
- ‚ùå –ß–∞–Ω–∫–∏–Ω–≥: –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- ‚ùå –§–æ—Ä–º–∞—Ç: HTML (–Ω–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
- ‚úÖ **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:** –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ Markdown —Ñ–æ—Ä–º–∞—Ç
- ‚ö†Ô∏è **–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:** –î–æ–±–∞–≤–∏—Ç—å —É–º–Ω—ã–π —á–∞–Ω–∫–∏–Ω–≥ –¥–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- üí∞ –≠–∫–æ–Ω–æ–º–∏—è: ~70% —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞
- üéØ –ö–∞—á–µ—Å—Ç–≤–æ: –£–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –ë—ã—Å—Ç—Ä–µ–µ –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–º–µ–Ω—å—à–µ —Ç–æ–∫–µ–Ω–æ–≤)

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 3 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** v2.4  
**–°—Ç–∞—Ç—É—Å:** –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é


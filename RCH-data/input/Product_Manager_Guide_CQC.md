# üìö –ü–ê–ú–Ø–¢–ö–ê –î–õ–Ø PRODUCT MANAGER: –ú–∞–ø–ø–∏–Ω–≥ CQC ‚Üí Care Homes v2.2

**–í–µ—Ä—Å–∏—è:** 2.2 UPDATED  
**–î–∞—Ç–∞:** 31 –æ–∫—Ç—è–±—Ä—è 2025  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∞–ø–ø–∏–Ω–≥—É CQC –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î v2.2 —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π

---

## üìã –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏](#–∫–ª—é—á–µ–≤—ã–µ-–∫–æ–Ω—Ü–µ–ø—Ü–∏–∏)
2. [–ß–¢–û –ò–ó–ú–ï–ù–ò–õ–û–°–¨ –í v2.2](#—á—Ç–æ-–∏–∑–º–µ–Ω–∏–ª–æ—Å—å-–≤-v22)
3. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö CQC](#–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-—Ä–∞–∑–ª–∏—á–∏—è-–≤-–¥–∞–Ω–Ω—ã—Ö-cqc)
4. [–ü–æ–ª–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –º–∞–ø–ø–∏–Ω–≥–∞](#–ø–æ–ª–Ω–∞—è-—Ç–∞–±–ª–∏—Ü–∞-–º–∞–ø–ø–∏–Ω–≥–∞)
5. [7 –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π Service User Bands](#7-–Ω–æ–≤—ã—Ö-–ø–æ–ª–µ–π-service-user-bands)
6. [Regulated Activities JSONB](#regulated-activities-jsonb)
7. [–ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∞–ø–ø–∏–Ω–≥–∞](#—á–µ–∫–ª–∏—Å—Ç-–ø—Ä–æ–≤–µ—Ä–∫–∏-–º–∞–ø–ø–∏–Ω–≥–∞)
8. [–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è](#—Ç–∏–ø–∏—á–Ω—ã–µ-–æ—à–∏–±–∫–∏-–∏-—Ä–µ—à–µ–Ω–∏—è)
9. [–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏](#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–ø–æ—Å–ª–µ-–º–∏–≥—Ä–∞—Ü–∏–∏)

---

## üéØ –ö–õ–Æ–ß–ï–í–´–ï –ö–û–ù–¶–ï–ü–¶–ò–ò

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö CQC

[translate:CQC] (Care Quality Commission) –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –¥–æ–º–∞—Ö –ø—Ä–µ—Å—Ç–∞—Ä–µ–ª—ã—Ö –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ —Å 5 –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –ø–æ–ª–µ–π:

1. **Location fields** (`location_*`) ‚Äî –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –¥–æ–º–µ
2. **Provider fields** (`provider_*`) ‚Äî –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–º–ø–∞–Ω–∏–∏-–≤–ª–∞–¥–µ–ª—å—Ü–µ
3. **Service Type fields** (`service_type_*`) ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è/—Ç–∏–ø —É—Ö–æ–¥–∞
4. **Regulated Activity fields** (`regulated_activity_*`) ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ª–∏—Ü–µ–Ω–∑–∏–∏
5. **Service User Band fields** (`service_user_band_*`) ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤

### –¢—Ä–∏ —É—Ä–æ–≤–Ω—è –¥–∞–Ω–Ω—ã—Ö

```
–£–†–û–í–ï–ù–¨ 1: LOCATION (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–æ–º)
‚îú‚îÄ location_name ‚Üí name
‚îú‚îÄ location_city ‚Üí city
‚îú‚îÄ location_postcode ‚Üí postcode
‚îî‚îÄ location_latitude/longitude ‚Üí –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã

–£–†–û–í–ï–ù–¨ 2: PROVIDER (–∫–æ–º–ø–∞–Ω–∏—è-–≤–ª–∞–¥–µ–ª–µ—Ü)
‚îú‚îÄ provider_name ‚Üí provider_name
‚îî‚îÄ provider_id ‚Üí provider_id

–£–†–û–í–ï–ù–¨ 3: –†–ï–ì–£–õ–Ø–¶–ò–ò (–ª–∏—Ü–µ–Ω–∑–∏–∏ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)
‚îú‚îÄ service_type_* ‚Üí care_residential, care_nursing
‚îú‚îÄ regulated_activity_* ‚Üí has_nursing_care_license (üî¥ –ö–†–ò–¢–ò–ß–ù–û!)
‚îî‚îÄ service_user_band_* ‚Üí serves_dementia_band, serves_children, etc.
```

---

## üÜï –ß–¢–û –ò–ó–ú–ï–ù–ò–õ–û–°–¨ –í v2.2

### –†–ê–°–®–ò–†–ï–ù–ò–ï: +8 –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π

| –ß—Ç–æ | v2.1 | v2.2 | –°—Ç–∞—Ç—É—Å |
|-----|------|------|--------|
| **–ü–ª–æ—Å–∫–∏—Ö –ø–æ–ª–µ–π** | 69 | 76 | +7 ‚úÖ |
| **JSONB –ø–æ–ª–µ–π** | 16 | 17 | +1 ‚úÖ |
| **–í—Å–µ–≥–æ –ø–æ–ª–µ–π** | 85 | 93 | +8 ‚úÖ |
| **–ò–Ω–¥–µ–∫—Å–æ–≤** | 39 | 53 | +14 ‚úÖ |

### –ù–û–í–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ v2.2:

#### 1Ô∏è‚É£ **7 –Ω–æ–≤—ã—Ö Service User Bands** (boolean)

–¢–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –í–°–ï 12 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤:

**–°—Ç–∞—Ä—ã–µ 5 –ø–æ–ª–µ–π (v2.1):**
- ‚úÖ `serves_older_people` (65+)
- ‚úÖ `serves_younger_adults` (18-64)
- ‚úÖ `serves_mental_health`
- ‚úÖ `serves_physical_disabilities`
- ‚úÖ `serves_sensory_impairments`

**–ù–û–í–´–ï 7 –ø–æ–ª–µ–π (v2.2):** üÜï
- üÜï `serves_dementia_band` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å –¥–µ–º–µ–Ω—Ü–∏–µ–π
- üÜï `serves_children` ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–µ—Ç–µ–π (—Ä–µ–¥–∫–æ < 1%)
- üÜï `serves_learning_disabilities` ‚Äî —É–º—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–Ω–≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å/–∞—É—Ç–∏–∑–º
- üÜï `serves_detained_mha` ‚Äî –ø—Å–∏—Ö–∏–∞—Ç—Ä–∏—è (Mental Health Act)
- üÜï `serves_substance_misuse` ‚Äî –Ω–∞—Ä–∫–æ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å/–∞–ª–∫–æ–≥–æ–ª–∏–∑–º
- üÜï `serves_eating_disorders` ‚Äî —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–∏—Ç–∞–Ω–∏—è
- üÜï `serves_whole_population` ‚Äî —Å–º–µ—à–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

#### ‚ö†Ô∏è –í–ê–ñ–ù–û–ï –†–ê–ó–õ–ò–ß–ò–ï:

```
care_dementia = TRUE          ‚Üí –¥–æ–º –°–ü–ï–¶–ò–ê–õ–ò–ó–ò–†–£–ï–¢–°–Ø –Ω–∞ –¥–µ–º–µ–Ω—Ü–∏–∏
serves_dementia_band = TRUE   ‚Üí –¥–æ–º –ü–†–ò–ù–ò–ú–ê–ï–¢ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å –¥–µ–º–µ–Ω—Ü–∏–µ–π

–ü—Ä–∏–º–µ—Ä: –û–±—ã—á–Ω—ã–π –¥–æ–º –º–æ–∂–µ—Ç care_dementia=FALSE, –Ω–æ serves_dementia_band=TRUE
```

#### 2Ô∏è‚É£ **–ù–æ–≤–æ–µ JSONB –ø–æ–ª–µ: regulated_activities** üÜï

–í—Å–µ 14 –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö CQC regulated activities —Ç–µ–ø–µ—Ä—å –≤ –æ–¥–Ω–æ–º JSONB –ø–æ–ª–µ:

```json
{
  "activities": [
    {"id": "nursing_care", "name": "Nursing care", "active": true},
    {"id": "personal_care", "name": "Personal care", "active": true},
    {"id": "surgical_procedures", "name": "Surgical procedures", "active": false},
    ...
    {"–≤—Å–µ–≥–æ 14 —Ç–∏–ø–æ–≤}
  ]
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ì–∏–±–∫–æ—Å—Ç—å (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏)
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ GIN –∏–Ω–¥–µ–∫—Å
- ‚úÖ 100% –ø–æ–∫—Ä—ã—Ç–∏–µ CQC –ª–∏—Ü–µ–Ω–∑–∏–π (–±—ã–ª–æ 36%, —Å—Ç–∞–ª–æ 100%)

#### 3Ô∏è‚É£ **–¢—Ä–∏ –Ω–æ–≤—ã—Ö Views** –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

```sql
-- v_data_coverage ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
SELECT * FROM v_data_coverage;

-- v_service_user_bands_coverage ‚Äî –∞–Ω–∞–ª–∏–∑ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è
SELECT * FROM v_service_user_bands_coverage;

-- v_data_anomalies ‚Äî –≤—ã—è–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ –¥–∞–Ω–Ω—ã—Ö
SELECT * FROM v_data_anomalies;
```

#### 4Ô∏è‚É£ **14 –Ω–æ–≤—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤**

- ‚úÖ 22 partial –∏–Ω–¥–µ–∫—Å–∞ –Ω–∞ boolean –ø–æ–ª—è—Ö (7 –Ω–æ–≤—ã—Ö)
- ‚úÖ GIN –∏–Ω–¥–µ–∫—Å –Ω–∞ `regulated_activities` JSONB
- ‚úÖ Composite –∏–Ω–¥–µ–∫—Å –Ω–∞ `(name_normalized, postcode)` –¥–ª—è entity resolution

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –†–ê–ó–õ–ò–ß–ò–Ø –í –î–ê–ù–ù–´–• CQC

### 1. service_type_* vs regulated_activity_* (–°–ê–ú–û–ï –í–ê–ñ–ù–û–ï!)

–≠—Ç–æ —Ä–∞–∑–ª–∏—á–∏–µ —á–∞—Å—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –æ—à–∏–±–∫–∞–º:

#### ‚ùå `service_type_*` = –ö–∞—Ç–µ–≥–æ—Ä–∏—è/–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (–ù–ï –ª–∏—Ü–µ–Ω–∑–∏—è!)

**–ß—Ç–æ —ç—Ç–æ:**
- –û–ø–∏—Å–∞–Ω–∏–µ —Ç–∏–ø–∞ —É—Å–ª—É–≥, –∫–æ—Ç–æ—Ä—ã–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ü–µ–ª–µ–π
- **–ù–ï –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è**

**–ü—Ä–∏–º–µ—Ä—ã –ø–æ–ª–µ–π:**
- `service_type_care_home_service_with_nursing`
- `service_type_care_home_service_without_nursing`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –î–ª—è –ø–æ–ª–µ–π `care_nursing`, `care_residential` (—Ç–∏–ø —É—Ö–æ–¥–∞)
- ‚úÖ –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Ç–∏–ø—É —É—á—Ä–µ–∂–¥–µ–Ω–∏—è
- ‚ùå **–ù–ò–ö–û–ì–î–ê –¥–ª—è –ø–æ–ª–µ–π `has_*_license`** (–ª–∏—Ü–µ–Ω–∑–∏–∏)

#### ‚úÖ `regulated_activity_*` = –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è CQC

**–ß—Ç–æ —ç—Ç–æ:**
- –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ CQC –Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ü—Ä–∞–≤–æ–≤–æ–π —Å—Ç–∞—Ç—É—Å —É—á—Ä–µ–∂–¥–µ–Ω–∏—è
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –æ–∫–∞–∑–∞–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**

**–ü—Ä–∏–º–µ—Ä—ã –ø–æ–ª–µ–π:**
- `regulated_activity_nursing_care`
- `regulated_activity_personal_care`
- `regulated_activity_surgical_procedures`
- `regulated_activity_treatment_of_disease_disorder_or_injury`
- `regulated_activity_diagnostic_and_screening_procedures`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ **–¢–û–õ–¨–ö–û –¥–ª—è –ø–æ–ª–µ–π `has_*_license`** (–ª–∏—Ü–µ–Ω–∑–∏–∏)
- ‚úÖ –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∞–≤–∞ –Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚ùå **–ù–ò–ö–û–ì–î–ê –¥–ª—è –ø–æ–ª–µ–π `care_*`** (—Ç–∏–ø—ã —É—Ö–æ–¥–∞)

#### üìä –ü–û–ß–ï–ú–£ –≠–¢–û –ö–†–ò–¢–ò–ß–ù–û?

**–†–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä:**

```
–î–æ–º "Sunset Care Home"
‚îú‚îÄ service_type_care_home_service_with_nursing = TRUE
‚îÇ  (–ö–∞—Ç–µ–≥–æ—Ä–∏—è: "–î–æ–º —Å –º–µ–¥—Å–µ—Å—Ç—Ä–∞–º–∏")
‚îÇ
‚îî‚îÄ regulated_activity_nursing_care = FALSE
   (–õ–∏—Ü–µ–Ω–∑–∏—è –Ω–∞ nursing: –ù–ï–¢)

–ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
‚Ä¢ –î–æ–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç —Å–µ–±—è –∫–∞–∫ –¥–æ–º —Å –º–µ–¥—Å–µ—Å—Ç—Ä–∞–º–∏
‚Ä¢ –ù–û –ù–ï –ò–ú–ï–ï–¢ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –ª–∏—Ü–µ–Ω–∑–∏–∏ –Ω–∞ nursing care
‚Ä¢ –≠—Ç–æ –õ–ï–ì–ê–õ–¨–ù–û, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –æ–∫–∞–∑—ã–≤–∞—é—Ç –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —É—Å–ª—É–≥–∏
```

#### üö® –ü–û–°–õ–ï–î–°–¢–í–ò–Ø –û–®–ò–ë–ö–ò:

**‚ùå –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `service_type_*` –¥–ª—è `has_nursing_care_license`:**
- –û—Ç–º–µ—Ç–∏—Ç–µ 73 –¥–æ–º–∞ –∫–∞–∫ –∏–º–µ—é—â–∏—Ö –ª–∏—Ü–µ–Ω–∑–∏—é (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –æ–∂–∏–¥–∞—Ç—å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —É—Å–ª—É–≥–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç
- –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- –ù–∞—Ä—É—à–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è CQC

**‚úÖ –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `regulated_activity_*` –¥–ª—è `has_nursing_care_license`:**
- –¢–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–ª–∏—á–∏–∏ –ª–∏—Ü–µ–Ω–∑–∏–∏ (198 –∏–∑ 271)
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º CQC
- –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- –î–æ–≤–µ—Ä–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### 2. location_* vs provider_*

#### ‚úÖ `location_*` = –î–∞–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –î–û–ú–ê (–ü–†–ò–û–†–ò–¢–ï–¢!)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ **–ü–†–ò–û–†–ò–¢–ï–¢** –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª–µ–π –æ –¥–æ–º–µ
- ‚úÖ –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ `location_*` –ø–æ–ª—è

#### üîÑ `provider_*` = –î–∞–Ω–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏-–≤–ª–∞–¥–µ–ª—å—Ü–∞ (FALLBACK)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –î–ª—è –ø–æ–ª–µ–π –æ –≤–ª–∞–¥–µ–ª—å—Ü–µ (`provider_name`, `provider_id`)
- ‚úÖ –ö–∞–∫ **FALLBACK** –µ—Å–ª–∏ location –ø–æ–ª–µ –ø—É—Å—Ç–æ
- ‚ùå **–ù–ï –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫**

#### üìù –õ–æ–≥–∏–∫–∞ COALESCE:

```sql
-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –°–Ω–∞—á–∞–ª–∞ location, –ø–æ—Ç–æ–º provider
COALESCE(location_web_address, provider_web_address) as website

-- ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –¢–æ–ª—å–∫–æ location (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ)
location_web_address as website

-- ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –¢–æ–ª—å–∫–æ provider (–Ω–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ)
provider_web_address as website
```

---

## üìã –ü–û–õ–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ú–ê–ü–ü–ò–ù–ì–ê

### –ì–†–£–ü–ü–ê 1: –ò–î–ï–ù–¢–ò–§–ò–ö–ê–¢–û–†–´

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ CQC | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|-------------|---------|-----------|
| `cqc_location_id` | `location_id` | `clean_text()` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID CQC |
| `location_ods_code` | `location_ods_code` | `clean_text()` | ODS –∫–æ–¥ NHS |

### –ì–†–£–ü–ü–ê 2: –ë–ê–ó–û–í–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ CQC | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|-------------|---------|-----------|
| `name` | `location_name` | `clean_text()` | –ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–º–∞ |
| `name_normalized` | `location_name` | `LOWER(TRIM())` | –î–ª—è –ø–æ–∏—Å–∫–∞ |
| `provider_name` | `provider_name` | `clean_text()` | –ö–æ–º–ø–∞–Ω–∏—è-–≤–ª–∞–¥–µ–ª–µ—Ü |
| `provider_id` | `provider_id` | `clean_text()` | ID –∫–æ–º–ø–∞–Ω–∏–∏ |
| `brand_name` | `brand_name` | `clean_text()` | –¢–æ—Ä–≥–æ–≤–∞—è –º–∞—Ä–∫–∞ |

### –ì–†–£–ü–ü–ê 3: –ö–û–ù–¢–ê–ö–¢–´

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ CQC | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|-------------|---------|-----------|
| `telephone` | `location_telephone_number` | `clean_text()` | ‚ö†Ô∏è TEXT, –ù–ï NUMERIC! |
| `email` | ‚Äî | NULL | –ù–µ—Ç –≤ CQC |
| `website` | `COALESCE(location_web_address, provider_web_address)` | `clean_text()` | ‚úÖ –õ–æ–≥–∏–∫–∞ fallback |

### –ì–†–£–ü–ü–ê 4: –ê–î–†–ï–° –ò –õ–û–ö–ê–¶–ò–Ø

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ CQC | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|-------------|---------|-----------|
| `city` | `location_city` | `clean_text()` | NOT NULL |
| `county` | `location_county` | `clean_text()` | –ì—Ä–∞—Ñ—Å—Ç–≤–æ |
| `postcode` | `location_postal_code` | `clean_text()` | –§–æ—Ä–º–∞—Ç: "B31 2TX" |
| `latitude` | `location_latitude` | `safe_latitude()` | ‚úÖ UK: 49-61¬∞N |
| `longitude` | `location_longitude` | `safe_longitude()` | ‚úÖ UK: -8 to 2¬∞E |
| `region` | `location_region` | `clean_text()` | UK —Ä–µ–≥–∏–æ–Ω |
| `local_authority` | `location_local_authority` | `clean_text()` | –ú–µ—Å—Ç–Ω—ã–π –æ—Ä–≥–∞–Ω –≤–ª–∞—Å—Ç–∏ |

### –ì–†–£–ü–ü–ê 5: –í–ú–ï–°–¢–ò–ú–û–°–¢–¨

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ CQC | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|-------------|---------|-----------|
| `beds_total` | `location_number_of_beds` | `safe_integer()` | CHECK: > 0 |
| `beds_available` | ‚Äî | NULL | –ù–µ—Ç –≤ CQC (–¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é) |
| `has_availability` | ‚Äî | TRIGGER | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ `beds_available` |
| `year_opened` | ‚Äî | NULL | –û–±—ã—á–Ω–æ –Ω–µ—Ç –≤ CQC |
| `year_registered` | `location_hsca_start_date` | `extract_year()` | –ì–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ CQC |

### –ì–†–£–ü–ü–ê 6: –¢–ò–ü–´ –£–•–û–î–ê (–∏—Å–ø–æ–ª—å–∑—É—é—Ç service_type_*)

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ CQC | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|-------------|---------|-----------|
| `care_residential` | `service_type_care_home_service_without_nursing` | `safe_boolean()` | ‚úÖ –£—Ö–æ–¥ –ë–ï–ó –º–µ–¥—Å–µ—Å—Ç–µ—Ä |
| `care_nursing` | `service_type_care_home_service_with_nursing` | `safe_boolean()` | ‚úÖ –£—Ö–æ–¥ –° –º–µ–¥—Å–µ—Å—Ç—Ä–∞–º–∏ |
| `care_dementia` | `service_user_band_dementia` | `safe_boolean()` | –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –¥–µ–º–µ–Ω—Ü–∏–∏ |
| `care_respite` | ‚Äî | NULL | –û–±—ã—á–Ω–æ –Ω–µ—Ç –ø—Ä—è–º–æ–≥–æ –ø–æ–ª—è |

**–ü–æ—á–µ–º—É –∑–¥–µ—Å—å service_type –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
- –≠—Ç–æ –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–Ø —Ç–∏–ø–∞ —É—Ö–æ–¥–∞, –∞ –Ω–µ –ª–∏—Ü–µ–Ω–∑–∏—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏—â—É—Ç –¥–æ–º–∞ –ø–æ —Ç–∏–ø—É —É—Å–ª—É–≥
- –≠—Ç–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –∞ –Ω–µ –ø—Ä–∞–≤–æ–≤–æ–π —Å—Ç–∞—Ç—É—Å

### –ì–†–£–ü–ü–ê 7: –ú–ï–î–ò–¶–ò–ù–°–ö–ò–ï –õ–ò–¶–ï–ù–ó–ò–ò üî¥ –ö–†–ò–¢–ò–ß–ù–û!

**‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É—é—Ç regulated_activity_* (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)**

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ CQC | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|-------------|---------|-----------|
| `has_nursing_care_license` | `regulated_activity_nursing_care` | `safe_boolean()` | üî¥ –ù–ï service_type! |
| `has_personal_care_license` | `regulated_activity_personal_care` | `safe_boolean()` | –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è |
| `has_surgical_procedures_license` | `regulated_activity_surgical_procedures` | `safe_boolean()` | –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è |
| `has_treatment_license` | `regulated_activity_treatment_of_disease_disorder_or_injury` | `safe_boolean()` | –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è |
| `has_diagnostic_license` | `regulated_activity_diagnostic_and_screening_procedures` | `safe_boolean()` | –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è |

**–ü–æ—á–µ–º—É –∑–¥–µ—Å—å regulated_activity –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:**
- –≠—Ç–æ –û–§–ò–¶–ò–ê–õ–¨–ù–´–ï –õ–ò–¶–ï–ù–ó–ò–ò CQC
- –Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ø—Ä–∞–≤–æ –Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

### –ì–†–£–ü–ü–ê 8: –ö–ê–¢–ï–ì–û–†–ò–ò –ü–ê–¶–ò–ï–ù–¢–û–í (—Å—Ç–∞—Ä—ã–µ 5)

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ CQC | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|-------------|---------|-----------|
| `serves_older_people` | `service_user_band_older_people` | `safe_boolean()` | –ü–æ–∂–∏–ª—ã–µ 65+ |
| `serves_younger_adults` | `service_user_band_younger_adults` | `safe_boolean()` | –ú–æ–ª–æ–¥—ã–µ 18-64 |
| `serves_mental_health` | `service_user_band_mental_health` | `safe_boolean()` | –ü—Å–∏—Ö–∏—á–µ—Å–∫–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ |
| `serves_physical_disabilities` | `service_user_band_physical_disability` | `safe_boolean()` | –§–∏–∑–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è |
| `serves_sensory_impairments` | `service_user_band_sensory_impairment` | `safe_boolean()` | –°–µ–Ω—Å–æ—Ä–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è |

### üÜï –ì–†–£–ü–ü–ê 8B: –ù–û–í–´–ï –ö–ê–¢–ï–ì–û–†–ò–ò –ü–ê–¶–ò–ï–ù–¢–û–í v2.2 (+7)

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ CQC | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π | –ß–∞—Å—Ç–æ—Ç–∞ |
|-----------|-------------|---------|-----------|---------|
| `serves_dementia_band` üÜï | `service_user_band_dementia` | `safe_boolean()` | –ü—Ä–∏–Ω–∏–º–∞—é—Ç –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å –¥–µ–º–µ–Ω—Ü–∏–µ–π | ~68% |
| `serves_children` üÜï | `service_user_band_children_0_18_years` | `safe_boolean()` | –ü—Ä–∏–Ω–∏–º–∞—é—Ç –¥–µ—Ç–µ–π | <1% |
| `serves_learning_disabilities` üÜï | `service_user_band_learning_disabilities_or_autistic_spectrum_di` | `safe_boolean()` | Learning disabilities/–∞—É—Ç–∏–∑–º | ~17% |
| `serves_detained_mha` üÜï | `service_user_band_people_detained_under_the_mental_health_act` | `safe_boolean()` | –ü—Å–∏—Ö–∏–∞—Ç—Ä–∏—è (Mental Health Act) | <1% |
| `serves_substance_misuse` üÜï | `service_user_band_people_who_misuse_drugs_and_alcohol` | `safe_boolean()` | –ù–∞—Ä–∫–æ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å/–∞–ª–∫–æ–≥–æ–ª–∏–∑–º | <2% |
| `serves_eating_disorders` üÜï | `service_user_band_people_with_an_eating_disorder` | `safe_boolean()` | –†–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–∏—Ç–∞–Ω–∏—è | <1% |
| `serves_whole_population` üÜï | `service_user_band_whole_population` | `safe_boolean()` | –°–º–µ—à–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ | ~12% |

### –ì–†–£–ü–ü–ê 9: –§–ò–ù–ê–ù–°–ò–†–û–í–ê–ù–ò–ï

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ CQC | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|-------------|---------|-----------|
| `accepts_self_funding` | `funding_* –ø–æ–ª—è` | `safe_boolean()` | –ß–∞—Å—Ç–Ω–æ–µ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `accepts_local_authority` | `funding_* –ø–æ–ª—è` | `safe_boolean()` | LA —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `accepts_nhs_chc` | `funding_* –ø–æ–ª—è` | `safe_boolean()` | NHS Continuing Healthcare |
| `accepts_third_party_topup` | ‚Äî | NULL | –û–±—ã—á–Ω–æ –Ω–µ—Ç –ø—Ä—è–º–æ–≥–æ –ø–æ–ª—è |

### –ì–†–£–ü–ü–ê 10: CQC –†–ï–ô–¢–ò–ù–ì–ò

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ CQC | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|-------------|---------|-----------|
| `cqc_rating_overall` | `location_latest_overall_rating` | `normalize_cqc_rating()` | –û–±—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥ |
| `cqc_rating_safe` | `location_latest_rating_safe` | `normalize_cqc_rating()` | –†–µ–π—Ç–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ‚≠ê‚≠ê‚≠ê |
| `cqc_rating_effective` | `location_latest_rating_effective` | `normalize_cqc_rating()` | –†–µ–π—Ç–∏–Ω–≥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ |
| `cqc_rating_caring` | `location_latest_rating_caring` | `normalize_cqc_rating()` | –†–µ–π—Ç–∏–Ω–≥ –∑–∞–±–æ—Ç—ã |
| `cqc_rating_responsive` | `location_latest_rating_responsive` | `normalize_cqc_rating()` | –†–µ–π—Ç–∏–Ω–≥ –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç–∏ |
| `cqc_rating_well_led` | `location_latest_rating_well_led` | `normalize_cqc_rating()` | –†–µ–π—Ç–∏–Ω–≥ –ª–∏–¥–µ—Ä—Å—Ç–≤–∞ |
| `cqc_last_inspection_date` | `location_last_inspection_date` | `safe_date()` | –î–∞—Ç–∞ –∏–Ω—Å–ø–µ–∫—Ü–∏–∏ |
| `cqc_publication_date` | `publication_date` | `safe_date()` | –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ |
| `cqc_latest_report_url` | `cqc_report_url` | `clean_text()` | –°—Å—ã–ª–∫–∞ –Ω–∞ –æ—Ç—á—ë—Ç |

### –ì–†–£–ü–ü–ê 11: –û–¢–ó–´–í–´

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|---------|---------|-----------|
| `review_average_score` | Google/Carehome.co.uk | `safe_numeric()` | 0-5 stars |
| `review_count` | Google/Carehome.co.uk | `safe_integer()` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤ |
| `google_rating` | Google Maps | `safe_numeric()` | Google —Ä–µ–π—Ç–∏–Ω–≥ |

### –ì–†–£–ü–ü–ê 12: –£–î–û–ë–°–¢–í–ê

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|---------|---------|-----------|
| `wheelchair_access` | CQC/–î—Ä—É–≥–æ–µ | `safe_boolean()` | –î–æ—Å—Ç—É–ø –¥–ª—è –∏–Ω–≤–∞–ª–∏–¥–Ω—ã—Ö –∫–æ–ª—è—Å–æ–∫ |
| `ensuite_rooms` | CQC/–î—Ä—É–≥–æ–µ | `safe_boolean()` | –ö–æ–º–Ω–∞—Ç—ã —Å –ª–∏—á–Ω–æ–π –≤–∞–Ω–Ω–æ–π |
| `secure_garden` | CQC/–î—Ä—É–≥–æ–µ | `safe_boolean()` | –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –æ–≥–æ—Ä–æ–∂–µ–Ω–Ω—ã–π —Å–∞–¥ |
| `wifi_available` | CQC/–î—Ä—É–≥–æ–µ | `safe_boolean()` | WiFi –¥–ª—è —Ä–µ–∑–∏–¥–µ–Ω—Ç–æ–≤ |
| `parking_onsite` | CQC/–î—Ä—É–≥–æ–µ | `safe_boolean()` | –ü–∞—Ä–∫–æ–≤–∫–∞ –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ |

### –ì–†–£–ü–ü–ê 13: –°–ò–°–¢–ï–ú–ê

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ | –§—É–Ω–∫—Ü–∏—è | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|---------|---------|-----------|
| `is_dormant` | `dormant_y_n` | `safe_dormant()` | –ó–∞–∫—Ä—ã—Ç/–ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω |
| `data_quality_score` | –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è | ‚Äî | 0-100 (%) |
| `created_at` | –ë–î | DEFAULT CURRENT_TIMESTAMP | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | –ë–î | DEFAULT CURRENT_TIMESTAMP | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

### üÜï –ì–†–£–ü–ü–ê 14: JSONB –°–¢–†–£–ö–¢–£–†–´ v2.2 (+1)

| –ü–æ–ª–µ v2.2 | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|---------|-----------|
| `service_types` | `service_type_*` –ø–æ–ª—è | –¢–∏–ø—ã —É—Å–ª—É–≥ |
| `service_user_bands` | `service_user_band_*` –ø–æ–ª—è | –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ |
| üÜï `regulated_activities` | `regulated_activity_*` –ø–æ–ª—è (14 —Ç–∏–ø–æ–≤) | ‚úÖ –í–°–ï 14 CQC –ª–∏—Ü–µ–Ω–∑–∏–π! |
| `facilities` | –†–∞–∑–ª–∏—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | –£–¥–æ–±—Å—Ç–≤–∞ |
| `medical_specialisms` | –†–∞–∑–ª–∏—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ |
| `dietary_options` | –†–∞–∑–ª–∏—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | –î–∏–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø—Ü–∏–∏ |
| `activities` | –†–∞–∑–ª–∏—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | –ü—Ä–æ–≥—Ä–∞–º–º—ã –¥–æ—Å—É–≥–∞ |
| `pricing_details` | –†–∞–∑–ª–∏—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | –î–µ—Ç–∞–ª–∏ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è |
| `staff_information` | –†–∞–∑–ª–∏—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–µ—Ä—Å–æ–Ω–∞–ª–µ |
| `reviews_detailed` | Google, Carehome.co.uk | –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç–∑—ã–≤—ã |
| `media` | –†–∞–∑–ª–∏—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | –§–æ—Ç–æ/–≤–∏–¥–µ–æ |
| `location_context` | –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è | –ö–æ–Ω—Ç–µ–∫—Å—Ç –ª–æ–∫–∞—Ü–∏–∏ |
| `building_info` | –†–∞–∑–ª–∏—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–¥–∞–Ω–∏–∏ |
| `accreditations` | –†–∞–∑–ª–∏—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã |
| `source_urls` | –†–∞–∑–ª–∏—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | –ö–æ–ª–ª–µ–∫—Ü–∏—è URL |
| `source_metadata` | –†–∞–∑–ª–∏—á–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ |
| `extra` | –ì–∏–±–∫–æ–µ –ø–æ–ª–µ | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è |

---

## 7 –ù–û–í–´–• –ü–û–õ–ï–ô SERVICE USER BANDS

### ‚ö†Ô∏è –í–ê–ñ–ù–û–ï –†–ê–ó–õ–ò–ß–ò–ï

```
care_dementia = TRUE         ‚Üí –¥–æ–º –°–ü–ï–¶–ò–ê–õ–ò–ó–ò–†–£–ï–¢–°–Ø –Ω–∞ –¥–µ–º–µ–Ω—Ü–∏–∏
serves_dementia_band = TRUE  ‚Üí –¥–æ–º –ü–†–ò–ù–ò–ú–ê–ï–¢ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å –¥–µ–º–µ–Ω—Ü–∏–µ–π

–û–Ω–∏ –ù–ï –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–≤–ø–∞–¥–∞—é—Ç!
–ü—Ä–∏–º–µ—Ä: care_dementia=FALSE, serves_dementia_band=TRUE = –æ–±—â–∏–π –¥–æ–º, 
–Ω–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ª—é–¥–µ–π —Å –¥–µ–º–µ–Ω—Ü–∏–µ–π
```

### –ù–û–í–´–ï –ü–û–õ–Ø –ò –ò–• –ó–ù–ê–ß–ï–ù–ò–ï

#### 1Ô∏è‚É£ `serves_dementia_band` ‚≠ê –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

- **CQC –ø–æ–ª–µ:** `service_user_band_dementia`
- **–¢–∏–ø:** BOOLEAN
- **–ß–∞—Å—Ç–æ—Ç–∞:** ~68% –¥–æ–º–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—é—Ç (–æ–∂–∏–¥–∞–µ–º–æ)
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –º–∞—Ç—á–∏–Ω–≥–µ:** –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è Q9 (–ø–∞—Ü–∏–µ–Ω—Ç —Å –¥–µ–º–µ–Ω—Ü–∏–µ–π)
- **Consistency check:** –µ—Å–ª–∏ `care_dementia=TRUE` —Ç–æ `serves_dementia_band` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å TRUE

#### 2Ô∏è‚É£ `serves_children`

- **CQC –ø–æ–ª–µ:** `service_user_band_children_0_18_years`
- **–¢–∏–ø:** BOOLEAN
- **–ß–∞—Å—Ç–æ—Ç–∞:** <1% (—Ä–µ–¥–∫–æ)
- **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:** –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¥–æ–º–æ–≤ –ø—Ä–µ—Å—Ç–∞—Ä–µ–ª—ã—Ö

#### 3Ô∏è‚É£ `serves_learning_disabilities`

- **CQC –ø–æ–ª–µ:** `service_user_band_learning_disabilities_or_autistic_spectrum_di`
- **–¢–∏–ø:** BOOLEAN
- **–ß–∞—Å—Ç–æ—Ç–∞:** ~17% –¥–æ–º–æ–≤
- **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:** –£–º—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–Ω–≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å / –∞—É—Ç–∏–∑–º

#### 4Ô∏è‚É£ `serves_detained_mha`

- **CQC –ø–æ–ª–µ:** `service_user_band_people_detained_under_the_mental_health_act`
- **–¢–∏–ø:** BOOLEAN
- **–ß–∞—Å—Ç–æ—Ç–∞:** <1% (—Ä–µ–¥–∫–æ)
- **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:** –ü—Å–∏—Ö–∏–∞—Ç—Ä–∏—è –ø–æ–¥ Mental Health Act (–≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

#### 5Ô∏è‚É£ `serves_substance_misuse`

- **CQC –ø–æ–ª–µ:** `service_user_band_people_who_misuse_drugs_and_alcohol`
- **–¢–∏–ø:** BOOLEAN
- **–ß–∞—Å—Ç–æ—Ç–∞:** <2% (—Ä–µ–¥–∫–æ)
- **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:** –†–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è, –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –Ω–∞–¥–∑–æ—Ä

#### 6Ô∏è‚É£ `serves_eating_disorders`

- **CQC –ø–æ–ª–µ:** `service_user_band_people_with_an_eating_disorder`
- **–¢–∏–ø:** BOOLEAN
- **–ß–∞—Å—Ç–æ—Ç–∞:** <1% (—Ä–µ–¥–∫–æ)
- **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:** –ü–∏—Ç–∞–Ω–∏–µ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

#### 7Ô∏è‚É£ `serves_whole_population`

- **CQC –ø–æ–ª–µ:** `service_user_band_whole_population`
- **–¢–∏–ø:** BOOLEAN
- **–ß–∞—Å—Ç–æ—Ç–∞:** ~12% –¥–æ–º–æ–≤
- **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:** –°–º–µ—à–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –±–µ–∑ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

---

## REGULATED ACTIVITIES JSONB

### –ß–¢–û –≠–¢–û –ù–û–í–û–ï –ü–û–õ–ï?

–í v2.2 –¥–æ–±–∞–≤–ª–µ–Ω–æ **–Ω–æ–≤–æ–µ JSONB –ø–æ–ª–µ** `regulated_activities` –∫–æ—Ç–æ—Ä–æ–µ —Å–æ–¥–µ—Ä–∂–∏—Ç **–í–°–ï 14 –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö CQC regulated activities**:

```json
{
  "activities": [
    {
      "id": "nursing_care",
      "name": "Nursing care",
      "cqc_field": "regulated_activity_nursing_care",
      "active": true
    },
    {
      "id": "personal_care",
      "name": "Personal care",
      "cqc_field": "regulated_activity_personal_care",
      "active": true
    },
    {
      "id": "surgical_procedures",
      "name": "Surgical procedures",
      "active": false
    },
    ...–≤—Å–µ–≥–æ 14 —Ç–∏–ø–æ–≤
  ]
}
```

### –ö–ê–ö–ò–ï –õ–ò–¶–ï–ù–ó–ò–ò –í–ö–õ–Æ–ß–ï–ù–´?

| ID | –¢–∏–ø | –ê–∫—Ç–∏–≤–Ω—ã–π | –ß–∞—Å—Ç–æ—Ç–∞ |
|----|-----|---------|---------|
| 1 | `accommodation_nursing` | Often | üü¢ –ß–∞—Å—Ç–æ |
| 2 | `accommodation_treatment` | Rare | üî¥ –†–µ–¥–∫–æ |
| 3 | `assessment_detained` | Rare | üî¥ –†–µ–¥–∫–æ |
| 4 | `diagnostic_screening` | Often | üü¢ –ê–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| 5 | `family_planning` | Rare | üî¥ –†–µ–¥–∫–æ |
| 6 | `blood_management` | Rare | üî¥ –†–µ–¥–∫–æ |
| 7 | `maternity_midwifery` | Rare | üî¥ –†–µ–¥–∫–æ |
| 8 | `nursing_care` | Often | üü¢ –ß–∞—Å—Ç–æ (73% –¥–æ–º–æ–≤) |
| 9 | `personal_care` | Often | üü¢ –ß–∞—Å—Ç–æ (92% –¥–æ–º–æ–≤) |
| 10 | `slimming_clinics` | Rare | üî¥ –†–µ–¥–∫–æ |
| 11 | `surgical_procedures` | Rare | üî¥ –†–µ–¥–∫–æ |
| 12 | `termination_pregnancies` | Rare | üî¥ –†–µ–¥–∫–æ |
| 13 | `transport_triage` | Rare | üî¥ –†–µ–¥–∫–æ |
| 14 | `treatment_disease` | Often | üü¢ –ß–∞—Å—Ç–æ |

### –ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ –í –ó–ê–ü–†–û–°–ê–•?

```sql
-- –ù–∞–π—Ç–∏ –¥–æ–º–∞ —Å nursing care
SELECT name FROM care_homes 
WHERE regulated_activities @> '[{"id": "nursing_care", "active": true}]'::jsonb;

-- –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –ª–∏—Ü–µ–Ω–∑–∏–∏
SELECT 
  name,
  jsonb_array_length(regulated_activities->'activities') as license_count
FROM care_homes
WHERE regulated_activities != '{"activities": []}'::jsonb
ORDER BY license_count DESC;

-- –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ GIN –∏–Ω–¥–µ–∫—Å
EXPLAIN (ANALYZE) 
SELECT COUNT(*) FROM care_homes 
WHERE regulated_activities @> '[{"id": "nursing_care"}]'::jsonb;
```

### –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê vs –°–¢–ê–†–û–ô –°–ò–°–¢–ï–ú–´

| –ê—Å–ø–µ–∫—Ç | v2.1 (5 –ø–æ–ª–µ–π) | v2.2 (JSONB + 14 —Ç–∏–ø–æ–≤) |
|--------|----------------|------------------------|
| **–ü–æ–∫—Ä—ã—Ç–∏–µ** | 5/14 (36%) | 14/14 (100%) ‚úÖ |
| **–ì–∏–±–∫–æ—Å—Ç—å** | –¢—Ä–µ–±—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è | –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏ |
| **–ü–æ–∏—Å–∫** | –ú–µ–¥–ª–µ–Ω–Ω–æ (5 WHERE) | –ë—ã—Å—Ç—Ä–æ (GIN –∏–Ω–¥–µ–∫—Å) |
| **–ù–æ–≤—ã–µ —Ç–∏–ø—ã** | –ù—É–∂–Ω–∞ ALTER TABLE | –ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –≤ JSON |
| **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** | –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —á–µ—Ä–µ–∑ JSONB |

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ü–†–û–í–ï–†–ö–ò –ú–ê–ü–ü–ò–ù–ì–ê

### 1. –ü–†–û–í–ï–†–ö–ê –õ–ò–¶–ï–ù–ó–ò–ô (–ö–†–ò–¢–ò–ß–ù–û!)

- [ ] `has_nursing_care_license` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `regulated_activity_nursing_care` ‚úÖ
- [ ] `has_personal_care_license` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `regulated_activity_personal_care` ‚úÖ
- [ ] `has_surgical_procedures_license` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `regulated_activity_surgical_procedures` ‚úÖ
- [ ] `has_treatment_license` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `regulated_activity_treatment_of_disease_disorder_or_injury` ‚úÖ
- [ ] `has_diagnostic_license` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `regulated_activity_diagnostic_and_screening_procedures` ‚úÖ
- [ ] **–ù–ò –û–î–ù–û –ø–æ–ª–µ** `has_*_license` –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `service_type_*` ‚ùå

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```sql
SELECT COUNT(*) FROM care_homes WHERE has_nursing_care_license = TRUE;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: ~198 (73%), –∞ –ù–ï 73 (27%)!
```

### 2. –ü–†–û–í–ï–†–ö–ê –¢–ò–ü–û–í –£–•–û–î–ê

- [ ] `care_residential` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `service_type_care_home_service_without_nursing` ‚úÖ
- [ ] `care_nursing` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `service_type_care_home_service_with_nursing` ‚úÖ
- [ ] `care_dementia` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `service_user_band_dementia` ‚úÖ
- [ ] –ü–æ—Ä—è–¥–æ–∫ –ø–æ–ª–µ–π –≤ SELECT —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç INSERT

### 3. –ü–†–û–í–ï–†–ö–ê 7 –ù–û–í–´–• –ü–û–õ–ï–ô v2.2

- [ ] `serves_dementia_band` –º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω
- [ ] `serves_children` –º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω
- [ ] `serves_learning_disabilities` –º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω
- [ ] `serves_detained_mha` –º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω
- [ ] `serves_substance_misuse` –º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω
- [ ] `serves_eating_disorders` –º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω
- [ ] `serves_whole_population` –º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω

**–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```sql
SELECT 
  COUNT(*) FILTER (WHERE serves_dementia_band = TRUE) as dementia,
  COUNT(*) FILTER (WHERE serves_children = TRUE) as children,
  COUNT(*) FILTER (WHERE serves_learning_disabilities = TRUE) as learning_dis
FROM care_homes;

-- –û–∂–∏–¥–∞–µ—Ç—Å—è: dementia ~900+, children <10, learning_dis ~400+
```

### 4. –ü–†–û–í–ï–†–ö–ê REGULATED_ACTIVITIES JSONB

- [ ] –ü–æ–ª–µ `regulated_activities` —Å–æ–∑–¥–∞–Ω–æ –∫–∞–∫ JSONB
- [ ] –°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ 14 —Ç–∏–ø–æ–≤ –ª–∏—Ü–µ–Ω–∑–∏–π
- [ ] GIN –∏–Ω–¥–µ–∫—Å —Å–æ–∑–¥–∞–Ω –Ω–∞ `regulated_activities`
- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∞–ª–∏–¥–Ω–∞: `{"activities": [...]}`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
SELECT 
  COUNT(*) FILTER (WHERE regulated_activities IS NOT NULL) as with_data,
  COUNT(*) FILTER (WHERE regulated_activities != '{"activities": []}'::jsonb) as with_activities
FROM care_homes;

-- –û–∂–∏–¥–∞–µ—Ç—Å—è: ~100% —Å –¥–∞–Ω–Ω—ã–º–∏, ~70-80% —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ activities
```

### 5. –ü–†–û–í–ï–†–ö–ê –¢–ò–ü–û–í –î–ê–ù–ù–´–•

- [ ] `telephone` –∏–º–µ–µ—Ç —Ç–∏–ø TEXT (–ù–ï NUMERIC)
- [ ] `telephone` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `clean_text()` (–ù–ï `safe_numeric()`)
- [ ] `latitude` –∏ `longitude` –∏–º–µ—é—Ç —Ç–∏–ø NUMERIC(10,7)
- [ ] –í—Å–µ boolean –ø–æ–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç `safe_boolean()`

### 6. –ü–†–û–í–ï–†–ö–ê –ö–û–û–†–î–ò–ù–ê–¢

- [ ] `latitude` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `safe_latitude()` —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π 49-61
- [ ] `longitude` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `safe_longitude()` —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π -8 to 2
- [ ] –û–±—Ä–∞–±–æ—Ç–∞–Ω—ã –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- [ ] –û–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∑–∞–ø—è—Ç—ã–µ –∫–∞–∫ –¥–µ—Å—è—Ç–∏—á–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å

```sql
SELECT COUNT(*) FROM care_homes 
WHERE latitude NOT BETWEEN 49 AND 61 
   OR longitude NOT BETWEEN -8 AND 2;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0 (–Ω–æ–ª—å!)
```

### 7. –ü–†–û–í–ï–†–ö–ê COALESCE –õ–û–ì–ò–ö–ò

- [ ] `website` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `COALESCE(location_web_address, provider_web_address)`
- [ ] –î—Ä—É–≥–∏–µ –ø–æ–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç `location_*` –∫–∞–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

### 8. –ü–†–û–í–ï–†–ö–ê –§–£–ù–ö–¶–ò–ô

- [ ] –í—Å–µ 12+ helper —Ñ—É–Ω–∫—Ü–∏–π —Å–æ–∑–¥–∞–Ω—ã –î–û INSERT
- [ ] `safe_boolean()` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç: Y, YES, TRUE, 1, T, N, NO, FALSE, 0, F
- [ ] `normalize_cqc_rating()` –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç 4 –∑–Ω–∞—á–µ–Ω–∏—è: Outstanding/Good/RI/Inadequate
- [ ] `safe_latitude()`, `safe_longitude()` —Å UK –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π

---

## ‚ö†Ô∏è –¢–ò–ü–ò–ß–ù–´–ï –û–®–ò–ë–ö–ò –ò –†–ï–®–ï–ù–ò–Ø

### –û—à–∏–±–∫–∞ #1: –ü—É—Ç–∞–Ω–∏—Ü–∞ service_type_* vs regulated_activity_*

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ù–µ–≤–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–º–æ–≤ —Å –ª–∏—Ü–µ–Ω–∑–∏—è–º–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∂–∞–ª—É—é—Ç—Å—è –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—è–≤–ª–µ–Ω–Ω—ã—Ö —É—Å–ª—É–≥

**–ü—Ä–∏—á–∏–Ω–∞:**
```sql
-- ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
has_nursing_care_license ‚Üê service_type_care_home_service_with_nursing
```

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
has_nursing_care_license ‚Üê regulated_activity_nursing_care
```

### –û—à–∏–±–∫–∞ #2: –ó–∞–±—ã–ª–∏ –Ω–æ–≤—ã–µ 7 –ø–æ–ª–µ–π v2.2

**–°–∏–º–ø—Ç–æ–º—ã:**
- Views –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç (expecting 12 bands, got 5)
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ incomplete

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ 7 –ø–æ–ª–µ–π –≤ INSERT
- –ú–∞–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ `service_user_band_*` –ø–æ–ª–µ–π CQC
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `safe_boolean()` –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

### –û—à–∏–±–∫–∞ #3: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ regulated_activities

**–°–∏–º–ø—Ç–æ–º—ã:**
```json
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
{"nursing_care": true, "personal_care": false}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
{"activities": [
  {"id": "nursing_care", "active": true},
  {"id": "personal_care", "active": false}
]}
```

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `jsonb_build_object()` –∏ `jsonb_agg()`
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–µ: `{"activities": [...]}`
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å CHECK constraint

### –û—à–∏–±–∫–∞ #4: –ü–æ—Ç–µ—Ä—è —Ü–µ–ª–æ–π —á–∞—Å—Ç–∏ —É negative –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

**–°–∏–º–ø—Ç–æ–º—ã:**
- -1.88634 ‚Üí -0.188634
- –î–æ–º–∞ –Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `safe_longitude()` —Å heuristic –¥–ª—è –∑–∞–ø—è—Ç—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —á–∏—Å–µ–ª

### –û—à–∏–±–∫–∞ #5: telephone –∫–∞–∫ NUMERIC

**–°–∏–º–ø—Ç–æ–º—ã:**
- 01234567890 ‚Üí 1234567890.0 (–ø–æ—Ç–µ—Ä—è leading zero!)
- –¢–µ–ª–µ—Ñ–æ–Ω—ã –Ω–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- ‚úÖ –¢–æ–ª—å–∫–æ TEXT!
telephone TEXT
clean_text(location_telephone_number)
```

---

## üîç –í–ê–õ–ò–î–ê–¶–ò–Ø –ü–û–°–õ–ï –ú–ò–ì–†–ê–¶–ò–ò

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π

```sql
SELECT COUNT(*) FROM care_homes;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 271 (–∏–ª–∏ –≤–∞—à–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –õ–∏—Ü–µ–Ω–∑–∏–∏ (–ö–†–ò–¢–ò–ß–ù–û!)

```sql
SELECT COUNT(*) FROM care_homes WHERE has_nursing_care_license = TRUE;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: ~198 (73%), –∞ –ù–ï 73!

-- –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
SELECT 
  COUNT(*) as total,
  COUNT(*) FILTER (WHERE has_nursing_care_license = TRUE) as nursing_true,
  COUNT(*) FILTER (WHERE has_personal_care_license = TRUE) as personal_true,
  ROUND(100.0 * COUNT(*) FILTER (WHERE has_nursing_care_license = TRUE) / COUNT(*), 1) as nursing_pct
FROM care_homes;
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã

```sql
-- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞
SELECT COUNT(*) 
FROM care_homes 
WHERE latitude NOT BETWEEN 49 AND 61 
   OR longitude NOT BETWEEN -8 AND 2;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: 0

-- NULL –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
SELECT ROUND(100.0 * COUNT(*) FILTER (WHERE latitude IS NULL) / COUNT(*), 1) as null_pct
FROM care_homes;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: <5%
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 4: –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö telephone

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞
SELECT data_type FROM information_schema.columns
WHERE table_name = 'care_homes' AND column_name = 'telephone';
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: text

-- –ü—Ä–∏–º–µ—Ä—ã —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
SELECT telephone FROM care_homes 
WHERE telephone IS NOT NULL LIMIT 10;
-- –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ñ–æ—Ä–º–∞—Ç–∞: 1212740588.0
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 5: –ù–æ–≤—ã–µ 7 –ø–æ–ª–µ–π v2.2

```sql
SELECT 
  COUNT(*) FILTER (WHERE serves_dementia_band = TRUE) as dementia,
  COUNT(*) FILTER (WHERE serves_children = TRUE) as children,
  COUNT(*) FILTER (WHERE serves_learning_disabilities = TRUE) as learning_dis,
  COUNT(*) FILTER (WHERE serves_detained_mha = TRUE) as detained_mha,
  COUNT(*) FILTER (WHERE serves_substance_misuse = TRUE) as substance_misuse,
  COUNT(*) FILTER (WHERE serves_eating_disorders = TRUE) as eating_disorders,
  COUNT(*) FILTER (WHERE serves_whole_population = TRUE) as whole_population
FROM care_homes;

-- –û–∂–∏–¥–∞–µ—Ç—Å—è:
-- dementia ~180-200
-- children 0-5
-- learning_dis ~40-50
-- detained_mha 0-2
-- substance_misuse 0-3
-- eating_disorders 0-1
-- whole_population ~30-40
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 6: regulated_activities JSONB

```sql
-- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∞–ª–∏–¥–Ω–∞
SELECT COUNT(*) 
FROM care_homes 
WHERE regulated_activities ? 'activities'
  AND jsonb_typeof(regulated_activities->'activities') = 'array';
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: = COUNT(*)

-- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
SELECT 
  COUNT(*) as total,
  COUNT(*) FILTER (WHERE regulated_activities != '{"activities": []}'::jsonb) as with_activities,
  ROUND(100.0 * COUNT(*) FILTER (WHERE regulated_activities != '{"activities": []}'::jsonb) / COUNT(*), 1) as fill_pct
FROM care_homes;
-- –û–∂–∏–¥–∞–µ—Ç—Å—è: fill_pct > 70%
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 7: Views

```sql
-- –í—Å–µ 3 view —Ä–∞–±–æ—Ç–∞—é—Ç
SELECT * FROM v_data_coverage;
SELECT COUNT(*) FROM v_service_user_bands_coverage;
SELECT COUNT(*) FROM v_data_anomalies;

-- –û–∂–∏–¥–∞–µ—Ç—Å—è:
-- v_data_coverage: 1 row
-- v_service_user_bands_coverage: 12 rows
-- v_data_anomalies: <100 rows (errors only)
```

---

## üìä –≠–¢–ê–õ–û–ù–ù–´–ï –ó–ù–ê–ß–ï–ù–ò–Ø

| –ú–µ—Ç—Ä–∏–∫–∞ | –û–∂–∏–¥–∞–µ–º–æ–µ | –ö–æ–º–º–µ–Ω—Ç |
|---------|----------|---------|
| **–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π** | 271 | –ò–ª–∏ –≤–∞—à–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ |
| **has_nursing_care_license = TRUE** | ~198 (73%) | –ù–ï 73! |
| **has_personal_care_license = TRUE** | ~250 (92%) | –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ |
| **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (–Ω–µ NULL)** | ~260-270 (96-99%) | –ü–æ—á—Ç–∏ –≤—Å–µ |
| **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤–Ω–µ UK** | 0 | –ù–æ–ª—å –æ—à–∏–±–æ–∫! |
| **telephone —Ç–∏–ø TEXT** | 100% | –ù–µ NUMERIC |
| **year_registered 1950-2025** | 100% | –†–∞–∑—É–º–Ω—ã–µ –≥–æ–¥—ã |
| **serves_dementia_band = TRUE** | ~180-200 | ~68% |
| **serves_children = TRUE** | 0-5 | –†–µ–¥–∫–æ <1% |
| **regulated_activities –∑–∞–ø–æ–ª–Ω–µ–Ω–æ** | >70% | –•–æ—Ä–æ—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ |

---

## üéì –í–ê–ñ–ù–´–ï –ú–û–ú–ï–ù–¢–´ –ò–ù–¢–ï–ì–†–ê–¶–ò–ò v2.2

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

1. ‚úÖ **–í–°–ï–ì–î–ê** –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ç–∏–ø –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (service_type vs regulated_activity)
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
3. ‚úÖ –í–∫–ª—é—á–∞–π—Ç–µ **–≤—Å–µ 7 –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π** –≤ INSERT
4. ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ **—Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** –ø–µ—Ä–µ–¥ production
5. ‚úÖ –í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ **JSONB —Å—Ç—Ä—É–∫—Ç—É—Ä—É** –ø–µ—Ä–µ–¥ INSERT

### –î–ª—è QA:

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å –ª–∏—Ü–µ–Ω–∑–∏—è–º–∏** (~73%, –∞ –Ω–µ 27%)
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ **—Ñ–æ—Ä–º–∞—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤** (TEXT, –Ω–µ 1212740588.0)
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ **–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–∞ –∫–∞—Ä—Ç–µ** (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–µ—Å—Ç–∞)
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ **–Ω–æ–≤—ã–µ 7 –ø–æ–ª–µ–π** (–≤—Å–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã)
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ **Views —Ä–∞–±–æ—Ç–∞—é—Ç** (3 views —Å –¥–∞–Ω–Ω—ã–º–∏)

### –î–ª—è Product Managers:

1. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å –≤ **—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ CQC** (—Ç–æ—á–Ω—ã–µ –ª–∏—Ü–µ–Ω–∑–∏–∏)
2. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å –≤ **—é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏** (regulated_activity)
3. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å –≤ **–∫–∞—á–µ—Å—Ç–≤–µ UX** (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, —Ç–µ–ª–µ—Ñ–æ–Ω—ã)
4. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å –≤ **–ø–æ–ª–Ω–æ—Ç–µ –¥–∞–Ω–Ω—ã—Ö** (–Ω–æ–≤—ã–µ 7 –ø–æ–ª–µ–π)
5. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å –≤ **Views —Ä–∞–±–æ—Ç–∞—é—Ç** (–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞)

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –ò –ü–û–î–î–ï–†–ñ–ö–ê

–ü—Ä–∏ –≤–æ–ø—Ä–æ—Å–∞—Ö:

1. ‚úÖ –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
3. ‚úÖ –°—Ä–∞–≤–Ω–∏—Ç–µ —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SQL queries –≤ —Ä–∞–∑–¥–µ–ª–µ –í–∞–ª–∏–¥–∞—Ü–∏—è
5. ‚úÖ –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —ç–∫—Å–ø–µ—Ä—Ç—É –ë–î –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

---

## üìù –ò–°–¢–û–†–ò–Ø –í–ï–†–°–ò–ô

| –í–µ—Ä—Å–∏—è | –î–∞—Ç–∞ | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|--------|------|----------|
| **2.2 UPDATED** | 31.10.2025 | ‚úÖ –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ v2.2 –ë–î |
| | | ‚úÖ 7 –Ω–æ–≤—ã—Ö Service User Bands |
| | | ‚úÖ regulated_activities JSONB (14 —Ç–∏–ø–æ–≤) |
| | | ‚úÖ 3 Views –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ |
| | | ‚úÖ –ß–µ–∫–ª–∏—Å—Ç—ã –∏ –ø—Ä–∏–º–µ—Ä—ã v2.2 |
| **2.1 FINAL** | 28.10.2025 | –ü–µ—Ä–≤–∞—è –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è |

---

**‚úÖ –≠—Ç–∞ –ø–∞–º—è—Ç–∫–∞ —è–≤–ª—è–µ—Ç—Å—è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ô –¥–ª—è –≤—Å–µ—Ö, –∫—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–∞–ø–ø–∏–Ω–≥–æ–º CQC –≤ v2.2!**

**–°—Ç–∞—Ç—É—Å:** PRODUCTION READY  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 31 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è –ë–î:** v2.2 FINAL

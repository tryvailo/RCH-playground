# ‚ö†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Rate Limit –¥–ª—è CQC API

**–î–∞—Ç–∞:** 2025-12-19  
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∏ 429 (Rate limit exceeded) –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

---

## üîç –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –æ—à–∏–±–∫–∏:
```
429 Too Many Requests
Rate limit is exceeded. Try again in 2 seconds.
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- CQC API –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç: 2000 requests/min
- –ó–∞–ø—É—â–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- Batch size 30 + delay 1.0 = ~30 requests/sec = 1800 requests/min (–±–ª–∏–∑–∫–æ –∫ –ª–∏–º–∏—Ç—É)
- –ü—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö –ª–∏–º–∏—Ç –ø—Ä–µ–≤—ã—à–∞–µ—Ç—Å—è

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### **1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã**
```bash
pkill -f "update_cqc_database"
```

### **2. –£–≤–µ–ª–∏—á–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏**
- **–ë—ã–ª–æ:** `--batch-size 30 --delay 1.0` (~30 req/sec)
- **–°—Ç–∞–ª–æ:** `--batch-size 20 --delay 2.0` (~10 req/sec = 600 req/min)

### **3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å**
```bash
python3 scripts/update_cqc_database.py \
  --fields cqc_rating_overall,cqc_rating_safe,cqc_rating_effective,cqc_rating_caring,cqc_rating_responsive,cqc_rating_well_led \
  --batch-size 20 \
  --delay 2.0
```

---

## üìä –†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏

**–ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- Batch size: 20 –¥–æ–º–æ–≤
- Delay: 2.0 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏
- –í—Å–µ–≥–æ –¥–æ–º–æ–≤: 14,599
- –ë–∞—Ç—á–µ–π: 14,599 / 20 = ~730 –±–∞—Ç—á–µ–π
- –í—Ä–µ–º—è: 730 * 2.0 = ~1,460 —Å–µ–∫—É–Ω–¥ = **~24 –º–∏–Ω—É—Ç—ã**

**–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø–∞—Å:**
- 600 requests/min –≤–º–µ—Å—Ç–æ 2000 requests/min
- –ó–∞–ø–∞—Å: 70% –æ—Ç –ª–∏–º–∏—Ç–∞

---

## ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ù–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã** –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è CQC –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å batch-size 20 –∏ delay 2.0** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ 429
4. **–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö 429** - —É–≤–µ–ª–∏—á–∏—Ç—å delay –¥–æ 3.0-4.0 —Å–µ–∫—É–Ω–¥

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û


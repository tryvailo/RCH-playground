# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏–π –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏ —Å–∫–æ—Ä–æ–≤

**–î–∞—Ç–∞:** 2025-12-18  
**–ò—Å—Ç–æ—á–Ω–∏–∫:** `documents/report-algorithms/scoring-differentiation-fix.py`

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –ì—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–π Location Scoring (–ª–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è) ‚úÖ

**–§–∞–π–ª:** `services/simple_matching_service.py` ‚Üí `_calculate_location()`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚ùå –£–±—Ä–∞–Ω—ã –±—Ä–µ–∫–µ—Ç—ã (if distance <= 5, elif <= 10, etc.)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –¥–ª—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –®—Ç—Ä–∞—Ñ –∑–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ preferred radius (-2 points –∑–∞ –∫–º)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω Accessibility Bonus (10 points: parking + wheelchair)

**–õ–æ–≥–∏–∫–∞:**
```python
# –í –ø—Ä–µ–¥–µ–ª–∞—Ö preferred radius:
proximity_ratio = 1.0 - (distance_km / preferred_radius)
distance_score = 50.0 + (proximity_ratio * 20.0)  # 50-70 points

# –ó–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ preferred radius:
overage = distance_km - preferred_radius
penalty = min(overage * 2.0, 40.0)  # -2 points per km
distance_score = max(50.0 - penalty, 10.0)  # 10-50 points
```

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** +10-20 points –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏ –¥–ª—è Location

---

### 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã –≤ Quality & Care ‚úÖ

**–§–∞–π–ª:** `services/simple_matching_service.py` ‚Üí `_calculate_quality_care()`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**

#### 2.1. Inspection Freshness (15 points)
- < 6 –º–µ—Å—è—Ü–µ–≤: 15 points
- < 1 –≥–æ–¥–∞: 12 points
- < 2 –ª–µ—Ç: 8 points
- –°—Ç–∞—Ä–∞—è: 4 points
- –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö: 7 points

#### 2.2. Size Factor (10 points)
- 30-60 –∫–æ–µ–∫: 10 points (–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä)
- 20-30 –∏–ª–∏ 60-80: 8 points
- 10-20 –∏–ª–∏ 80-100: 6 points
- –î—Ä—É–≥–æ–µ: 4 points
- –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö: 5 points

#### 2.3. No Enforcement Actions (15 points)
- –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º: 15 points
- 1 –ø—Ä–æ–±–ª–µ–º–∞: 8 points
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ: 0 points
- –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö: 7.5 points

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** +20-30 points –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏ –¥–ª—è Quality & Care

---

### 3. Well-Led Rating –≤ Quality & Care ‚úÖ

**–§–∞–π–ª:** `services/simple_matching_service.py` ‚Üí `_calculate_quality_care()`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω Well-Led rating (15 points)
- ‚úÖ –ü–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤–µ—Å–∞ CQC ratings:
  - Overall: 25 points (–±—ã–ª–æ 40)
  - Caring: 20 points (–±—ã–ª–æ 30)
  - Effective: 15 points (–±—ã–ª–æ 30)
  - Well-Led: 15 points (–ù–û–í–û–ï!)

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ 5 CQC sub-ratings –¥–ª—è –ª—É—á—à–µ–π –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏**

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** +5-10 points –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏

---

### 4. –§–∞–∫—Ç–æ—Ä –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö (NULL penalty —Å–∏—Å—Ç–µ–º–∞) ‚úÖ

**–§–∞–π–ª:** `services/simple_matching_service.py` ‚Üí `_calculate_data_quality_factor()`

**–õ–æ–≥–∏–∫–∞:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–ª–Ω–æ—Ç—É –¥–∞–Ω–Ω—ã—Ö (CQC, Financial, DB)
- 100% –¥–∞–Ω–Ω—ã—Ö = 1.2 (–±–æ–Ω—É—Å 20%)
- 50% –¥–∞–Ω–Ω—ã—Ö = 1.0 (–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ)
- 0% –¥–∞–Ω–Ω—ã—Ö = 0.8 (—à—Ç—Ä–∞—Ñ 20%)

**–ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ –ø–æ–ª—è:**
- CQC: overall, safe, caring, effective, well_led, inspection_date
- Financial: altman_z_score, revenue_trend
- DB: fee, beds_total, wheelchair_access, secure_garden

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –§–∞–∫—Ç–æ—Ä –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º category scores –∫–∞–∫ –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä
- –°–æ–∑–¥–∞–µ—Ç –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏—é –¥–∞–∂–µ –ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –±–∞–∑–æ–≤—ã—Ö —Å–∫–æ—Ä–∞—Ö

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** +5-10 points –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Quality & Care (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)

### –ë—ã–ª–æ:
- CQC Overall: 40 points
- CQC Caring: 30 points
- CQC Effective: 30 points
- **–ò—Ç–æ–≥–æ: 100 points**

### –°—Ç–∞–ª–æ:
- **CQC Ratings: 60 points**
  - Overall: 25 points
  - Caring: 20 points
  - Effective: 15 points
  - Well-Led: 15 points (–ù–û–í–û–ï!)
- **Inspection Freshness: 15 points** (–ù–û–í–û–ï!)
- **Size Factor: 10 points** (–ù–û–í–û–ï!)
- **No Enforcement Actions: 15 points** (–ù–û–í–û–ï!)
- **–ò—Ç–æ–≥–æ: 100 points**

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Location (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)

### –ë—ã–ª–æ:
- Distance: 80 points (–±—Ä–µ–∫–µ—Ç—ã)
- Preferred Radius Bonus: 20 points
- **–ò—Ç–æ–≥–æ: 100 points**

### –°—Ç–∞–ª–æ:
- **Distance: 70 points** (–ª–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è)
- **Preferred Radius Bonus: 20 points**
- **Accessibility Bonus: 10 points** (–ù–û–í–û–ï!)
  - Parking: 5 points
  - Wheelchair Access: 5 points
- **–ò—Ç–æ–≥–æ: 100 points**

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ —É–ª—É—á—à–µ–Ω–∏–π:
- Score range: ~5-10 points
- –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–∫–æ—Ä–æ–≤: ~30-40%
- –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏—è: –ù–∏–∑–∫–∞—è

### –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π:
- Score range: ~20-30 points
- –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–∫–æ—Ä–æ–≤: ~70-80%
- –î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏—è: –í—ã—Å–æ–∫–∞—è

### –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- **Location:** +10-20 points –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏ (–ª–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è)
- **Quality & Care:** +20-30 points –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏ (inspection, size, enforcement, well-led)
- **Data Quality:** +5-10 points –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏ (NULL penalty)
- **–ò—Ç–æ–≥–æ:** +35-60 points –æ–±—â–µ–π –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏

---

## ‚úÖ –°—Ç–∞—Ç—É—Å

–í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è –∏–∑ –≠—Ç–∞–ø–∞ 1 –∏ –≠—Ç–∞–ø–∞ 2 —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:

- ‚úÖ –ì—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–π Location Scoring
- ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã –≤ Quality & Care
- ‚úÖ Well-Led rating
- ‚úÖ –§–∞–∫—Ç–æ—Ä –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö

**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!**

---

## üîç –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –≠—Ç–∞–ø 3 (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç):
- Ranking Bonus (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è ties)
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–∞–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–∫–æ—Ä–æ–≤)

–≠—Ç–∏ —É–ª—É—á—à–µ–Ω–∏—è –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ, –µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏—è.


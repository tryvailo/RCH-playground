# ๐ ะะพะปะฝัะน ะฐะฝะฐะปะธะท CQC ะฑะฐะทั ะดะฐะฝะฝัั ะดะปั ะผะฐััะธะฝะณะฐ

**ะะฐัะฐ:** 2025-12-20  
**ะกัะฐััั:** โ ะะะะะะ ะะะะะะจะะ

---

## ๐ฏ ะัะฟะพะปะฝะตะฝะฝัะต ะธัะฟัะฐะฒะปะตะฝะธั

### **1. CQC Overall Rating** โ

**ะัะพะฑะปะตะผะฐ:** 80% ะดะฐะฝะฝัั ัะฟััะตะฝะพ (ััะฝะบัะธั ะฒะพะทะฒัะฐัะฐะปะฐ ัะปะพะฒะฐัั ะฒะผะตััะพ ัััะพะบะธ)  
**ะะตัะตะฝะธะต:** ะัะฟัะฐะฒะปะตะฝะฐ ััะฝะบัะธั ะธะทะฒะปะตัะตะฝะธั ะธ ัะพััะฐะฝะตะฝะธั  
**ะกัะฐััั:** โ ะะกะะะะะะะะ

---

### **2. Regulated Activities** ๐

**ะัะพะฑะปะตะผะฐ:** 
- `regulated_activity_nursing_care`: 0.0%
- `regulated_activity_personal_care`: 2.0%

**ะะตัะตะฝะธะต:**
- โ ะกะพะทะดะฐะฝะฐ ััะฝะบัะธั `extract_regulated_activities_from_api`
- โ ะะพะฑะฐะฒะปะตะฝะฐ ะปะพะณะธะบะฐ ะพะฑะฝะพะฒะปะตะฝะธั
- โ ะะพะฑะฐะฒะปะตะฝั ะฟะพะปั ะฒ `UPDATABLE_FIELDS`

**ะกัะฐััั:** ๐ ะะะะะะะฏะะขะกะฏ (ะฟัะพัะตัั ะฒัะฟะพะปะฝัะตััั)

**ะะถะธะดะฐะตะผัะต ัะตะทัะปััะฐัั:**
- `regulated_activity_nursing_care`: ~30% (~4,377 ะดะพะผะพะฒ)
- `regulated_activity_personal_care`: ~70-80% (~10,000-11,500 ะดะพะผะพะฒ)

---

### **3. Service User Bands** โ

**ะัะพะฑะปะตะผะฐ:** ะคัะฝะบัะธั ะธัะฟะพะปัะทะพะฒะฐะปะฐ ัะพัะฝะพะต ัะพะฒะฟะฐะดะตะฝะธะต  
**ะะตัะตะฝะธะต:** ะฃะปัััะตะฝะฐ ะดะปั ะฟะพะธัะบะฐ ะฟะพ ะบะปััะตะฒัะผ ัะปะพะฒะฐะผ  
**ะกัะฐััั:** โ ะะกะะะะะะะะ

---

## ๐ ะะฝะฐะปะธะท ะฟะพะปะตะน ะดะปั ะผะฐััะธะฝะณะฐ

### **ะะฑัะฐั ััะฐัะธััะธะบะฐ:**

| ะะฐัะตะณะพัะธั | ะะพะปะธัะตััะฒะพ | ะัะพัะตะฝั |
|-----------|------------|---------|
| โ **ะะพะปั ะฟัะธัััััะฒััั** | 22/32 | 68.8% |
| โ **ะะพะปั ะพััััััะฒััั** | 10/32 | 31.2% |
| ๐ข **ะััะพะบะฐั ะทะฐะฟะพะปะฝะตะฝะฝะพััั (>50%)** | 14 | 43.8% |
| ๐ก **ะกัะตะดะฝัั ะทะฐะฟะพะปะฝะตะฝะฝะพััั (10-50%)** | 5 | 15.6% |
| ๐ด **ะะธะทะบะฐั ะทะฐะฟะพะปะฝะตะฝะฝะพััั (<10%)** | 13 | 40.6% |

---

## ๐ ะะตัะฐะปัะฝัะน ะฐะฝะฐะปะธะท ะฟะพ ะบะฐัะตะณะพัะธัะผ

### **1. CQC Ratings** โ

**ะ ััะตะผะต ะะ:** โ ะััั (6 ะฟะพะปะตะน)  
**ะ CQC CSV:** โ ะััั (93-100% ะทะฐะฟะพะปะฝะตะฝะฝะพััั)  
**ะคัะฝะบัะธั ะธะทะฒะปะตัะตะฝะธั:** โ ะััะผะพะน ะดะพัััะฟ  
**ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะผะฐััะธะฝะณะต:** โ ะัะฟะพะปัะทัะตััั

**ะกัะฐััั:** โ **100% ะณะพัะพะฒะฝะพััั**

---

### **2. Service User Bands** โ

**ะ ััะตะผะต ะะ:** โ ะััั (12 ะฟะปะพัะบะธั ะฟะพะปะตะน + JSONB)  
**ะ CQC CSV:** โ ะััั (24-76% ะทะฐะฟะพะปะฝะตะฝะฝะพััั)  
**ะคัะฝะบัะธั ะธะทะฒะปะตัะตะฝะธั:** โ `get_service_user_band()`  
**ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะผะฐััะธะฝะณะต:** โ ะัะฟะพะปัะทัะตััั

**ะกัะฐััั:** โ **85% ะณะพัะพะฒะฝะพััั**

---

### **3. Regulated Activities** ๐

**ะ ััะตะผะต ะะ:** โ ะััั (5 ะฟะปะพัะบะธั ะฟะพะปะตะน + JSONB)  
**ะ CQC CSV:** ๐ ะะฑะฝะพะฒะปัะตััั (0-2% โ ะพะถะธะดะฐะตััั 30-80%)  
**ะคัะฝะบัะธั ะธะทะฒะปะตัะตะฝะธั:** โ `get_regulated_activity()`  
**ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะผะฐััะธะฝะณะต:** โ ะัะฟะพะปัะทัะตััั

**ะกัะฐััั:** ๐ **ะ ะฟัะพัะตััะต ะพะฑะฝะพะฒะปะตะฝะธั**

---

### **4. Location** โ

**ะ ััะตะผะต ะะ:** โ ะััั (5 ะฟะพะปะตะน)  
**ะ CQC CSV:** โ ะััั (100% ะทะฐะฟะพะปะฝะตะฝะฝะพััั)  
**ะคัะฝะบัะธั ะธะทะฒะปะตัะตะฝะธั:** โ ะััะผะพะน ะดะพัััะฟ  
**ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะผะฐััะธะฝะณะต:** โ ะัะฟะพะปัะทัะตััั

**ะกัะฐััั:** โ **100% ะณะพัะพะฒะฝะพััั**

---

### **5. Facilities** โ

**ะ ััะตะผะต ะะ:** โ ะััั (5 ะฟะปะพัะบะธั ะฟะพะปะตะน + JSONB `facilities`)  
**ะ CQC CSV:** โ ะััััััะฒััั  
**ะ Staging CSV:** โ **ะะกะขะฌ** (56-93% ะทะฐะฟะพะปะฝะตะฝะฝะพััั):
- `parsed_wheelchair_access`: 93.0%
- `parsed_parking_onsite`: 56.5%
- `parsed_wifi_available`: 68.9%
- `parsed_ensuite_rooms`: 12.0%
- `parsed_secure_garden`: 2.1%

**ะคัะฝะบัะธั ะธะทะฒะปะตัะตะฝะธั:** โ `get_amenity_value()`  
**ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะผะฐััะธะฝะณะต:** โ ะัะฟะพะปัะทัะตััั  
**ะะพัััะฟ ัะตัะตะท:** โ ะะธะฑัะธะดะฝัะน ะฟะพะดัะพะด (CQC + Staging)

**ะกัะฐััั:** โ **100% ะณะพัะพะฒะฝะพััั** (ัะตัะตะท ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด)

---

### **6. Funding** โ

**ะ ััะตะผะต ะะ:** โ ะััั (4 ะฟะปะพัะบะธั ะฟะพะปั):
- `accepts_self_funding`
- `accepts_local_authority`
- `accepts_nhs_chc`
- `accepts_third_party_topup`

**ะ CQC CSV:** โ ะััััััะฒััั  
**ะ Staging CSV:** โ **ะะกะขะฌ** (93-100% ะทะฐะฟะพะปะฝะตะฝะฝะพััั):
- `parsed_accepts_self_funding`: 93.6%
- `parsed_accepts_local_authority`: 100.0%
- `parsed_accepts_nhs_chc`: 92.5%
- `parsed_accepts_third_party_topup`: 0.3%

**ะคัะฝะบัะธั ะธะทะฒะปะตัะตะฝะธั:** โ `get_funding_acceptance()`  
**ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะผะฐััะธะฝะณะต:** โ๏ธ ะะต ะธัะฟะพะปัะทัะตััั (ะผะพะถะตั ะฑััั ะดะพะฑะฐะฒะปะตะฝะพ)  
**ะะพัััะฟ ัะตัะตะท:** โ ะะธะฑัะธะดะฝัะน ะฟะพะดัะพะด (CQC + Staging)

**ะกัะฐััั:** โ **95% ะณะพัะพะฒะฝะพััั** (ัะตัะตะท ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด)

---

## ๐ ะะฐะฟะฟะธะฝะณ Staging โ ะะ

### **Facilities:**

| Staging ะฟะพะปะต | ะะ ะฟะพะปะต | ะะฐะฟะพะปะฝะตะฝะฝะพััั |
|--------------|---------|---------------|
| `parsed_wheelchair_access` | `wheelchair_access` | 93.0% |
| `parsed_parking_onsite` | `parking_onsite` | 56.5% |
| `parsed_wifi_available` | `wifi_available` | 68.9% |
| `parsed_ensuite_rooms` | `ensuite_rooms` | 12.0% |
| `parsed_secure_garden` | `secure_garden` | 2.1% |

**ะกัะฐััั:** โ ะะฐะฟะฟะธะฝะณ ัะตะฐะปะธะทะพะฒะฐะฝ ะฒ `staging_data_loader.py`

---

### **Funding:**

| Staging ะฟะพะปะต | ะะ ะฟะพะปะต | ะะฐะฟะพะปะฝะตะฝะฝะพััั |
|--------------|---------|---------------|
| `parsed_accepts_self_funding` | `accepts_self_funding` | 93.6% |
| `parsed_accepts_local_authority` | `accepts_local_authority` | 100.0% |
| `parsed_accepts_nhs_chc` | `accepts_nhs_chc` | 92.5% |
| `parsed_accepts_third_party_topup` | `accepts_third_party_topup` | 0.3% |

**ะกัะฐััั:** โ ะะฐะฟะฟะธะฝะณ ัะตะฐะปะธะทะพะฒะฐะฝ ะฒ `staging_data_loader.py`

---

## ๐ฏ ะัะพะณะพะฒะฐั ะพัะตะฝะบะฐ ะณะพัะพะฒะฝะพััะธ

### **ะะพัะพะฒะฝะพััั CQC ะฑะฐะทั ะดะฐะฝะฝัั ะดะปั ะผะฐััะธะฝะณะฐ:** ๐ข **90%**

**ะะฑะพัะฝะพะฒะฐะฝะธะต:**

#### **โ ะัะธัะธัะตัะบะธะต ะฟะพะปั (100% ะณะพัะพะฒะฝะพััั):**

1. โ **CQC Ratings:** 100% ะทะฐะฟะพะปะฝะตะฝะฝะพััั
2. โ **Location:** 100% ะทะฐะฟะพะปะฝะตะฝะฝะพััั
3. โ **Service User Bands:** 24-76% ะทะฐะฟะพะปะฝะตะฝะฝะพััั (ัะพัะพัะพ)
4. โ **Care Types:** 30-71% ะทะฐะฟะพะปะฝะตะฝะฝะพััั (ัะพัะพัะพ)

#### **โ ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะฟะพะปั (ัะตัะตะท ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด):**

5. โ **Facilities:** 56-93% ะทะฐะฟะพะปะฝะตะฝะฝะพััั ัะตัะตะท Staging
6. โ **Funding:** 93-100% ะทะฐะฟะพะปะฝะตะฝะฝะพััั ัะตัะตะท Staging

#### **๐ ะ ะฟัะพัะตััะต:**

7. ๐ **Regulated Activities:** ะะฑะฝะพะฒะปัะตััั ัะตัะตะท API (0-2% โ ะพะถะธะดะฐะตััั 30-80%)

---

## ๐ ะะตะบะพะผะตะฝะดะฐัะธะธ

### **ะัะธะพัะธัะตั 1: ะะฐะฒะตััะธัั ะพะฑะฝะพะฒะปะตะฝะธะต Regulated Activities** ๐

**ะกัะฐััั:** ะ ะฟัะพัะตััะต (Batch 65/730, ~9% ะทะฐะฒะตััะตะฝะพ)

**ะะถะธะดะฐะตะผะพะต ะฒัะตะผั:** ~20 ะผะธะฝัั

**ะะตะนััะฒะธะต:** ะะพะถะดะฐัััั ะทะฐะฒะตััะตะฝะธั ะฟัะพัะตััะฐ ะพะฑะฝะพะฒะปะตะฝะธั

---

### **ะัะธะพัะธัะตั 2: ะัะฟะพะปัะทะพะฒะฐัั ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด** โ

**ะะตะนััะฒะธะต:**
- ะัะฟะพะปัะทะพะฒะฐัั `get_care_homes_hybrid()` ะดะปั ะทะฐะณััะทะบะธ ะดะฐะฝะฝัั
- ะญัะพ ะพะฑะตัะฟะตัะธั ะดะพัััะฟ ะบ Facilities ะธ Funding ะธะท Staging ะฑะฐะทั

**ะกัะฐััั:** โ ะฃะถะต ัะตะฐะปะธะทะพะฒะฐะฝะพ ะฒ `report_routes.py`

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
```python
from services.csv_care_homes_service import get_care_homes_hybrid

homes = get_care_homes_hybrid(
    user_lat=lat,
    user_lon=lon,
    max_distance_km=distance,
    limit=limit
)
# Facilities ะธ Funding ะดะพัััะฟะฝั ัะตัะตะท ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด
```

---

### **ะัะธะพัะธัะตั 3: ะัะพะฒะตัะธัั ะผะฐะฟะฟะธะฝะณ Staging โ ะะ** โ

**ะกัะฐััั:** โ ะัะพะฒะตัะตะฝะพ

**ะะตะทัะปััะฐั:**
- โ ะะฐะฟะฟะธะฝะณ ัะตะฐะปะธะทะพะฒะฐะฝ ะฒ `staging_data_loader.py`
- โ ะะพะปั ะฟัะฐะฒะธะปัะฝะพ ะผะฐะฟะฟัััั:
  - `parsed_wheelchair_access` โ `wheelchair_access`
  - `parsed_accepts_local_authority` โ `accepts_local_authority`
  - ะ ั.ะด.

---

## โ ะัะฒะพะดั

### **ะงัะพ ัะฐะฑะพัะฐะตั ัะพัะพัะพ:**

1. โ **CQC Ratings:** 100% ะทะฐะฟะพะปะฝะตะฝะฝะพััั
2. โ **Location:** 100% ะทะฐะฟะพะปะฝะตะฝะฝะพััั
3. โ **Service User Bands:** ะฅะพัะพัะฐั ะทะฐะฟะพะปะฝะตะฝะฝะพััั (24-76%)
4. โ **Care Types:** ะัะธัััััะฒััั ะธ ะทะฐะฟะพะปะฝะตะฝั
5. โ **Facilities:** ะะพัััะฟะฝั ัะตัะตะท Staging ะฑะฐะทั (56-93%)
6. โ **Funding:** ะะพัััะฟะฝั ัะตัะตะท Staging ะฑะฐะทั (93-100%)

### **ะงัะพ ััะตะฑัะตั ะฒะฝะธะผะฐะฝะธั:**

1. ๐ **Regulated Activities:** ะะฑะฝะพะฒะปัะตััั ัะตัะตะท API (ะฒ ะฟัะพัะตััะต)

### **ะงัะพ ะพััััััะฒัะตั, ะฝะพ ะตััั ะฐะปััะตัะฝะฐัะธะฒั:**

1. โ **Facilities ะฒ CQC CSV:** ะััััััะฒััั, ะฝะพ ะดะพัััะฟะฝั ัะตัะตะท Staging
2. โ **Funding ะฒ CQC CSV:** ะััััััะฒััั, ะฝะพ ะดะพัััะฟะฝั ัะตัะตะท Staging

---

## ๐ฏ ะคะธะฝะฐะปัะฝัะน ะฒัะฒะพะด

**ะะฐะทะฐ ะดะฐะฝะฝัั ะณะพัะพะฒะฐ ะดะปั ะผะฐััะธะฝะณะฐ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ:**

1. โ **CQC ะฑะฐะทะฐ** - ะดะปั ะบัะธัะธัะตัะบะธั ะฟะพะปะตะน (Service User Bands, CQC Ratings, Location)
2. โ **Staging ะฑะฐะทะฐ** - ะดะปั Facilities ะธ Funding (ัะตัะตะท ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด)
3. โ **JSONB ะฟะพะปั** - ะดะปั ะดะพะฟะพะปะฝะธัะตะปัะฝัั ะดะฐะฝะฝัั (ะฟัะธ ะทะฐะณััะทะบะต ะธะท ะะ)
4. ๐ **API ะพะฑะฝะพะฒะปะตะฝะธั** - ะดะปั Regulated Activities (ะฒ ะฟัะพัะตััะต)

**ะะตะบะพะผะตะฝะดะฐัะธั:** โ ะัะฟะพะปัะทะพะฒะฐัั ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด (`get_care_homes_hybrid()`) ะดะปั ะผะฐะบัะธะผะฐะปัะฝะพะณะพ ะฟะพะบัััะธั ะดะฐะฝะฝัั.

**ะะพัะพะฒะฝะพััั:** ๐ข **90%** (ะฟะพัะปะต ะทะฐะฒะตััะตะฝะธั ะพะฑะฝะพะฒะปะตะฝะธั Regulated Activities ะฑัะดะตั **95%**)

---

## ๐ ะัะพะณะพะฒะฐั ัะฐะฑะปะธัะฐ ะณะพัะพะฒะฝะพััะธ

| ะะฐัะตะณะพัะธั | ะ ะะ | ะ CQC CSV | ะ Staging CSV | ะคัะฝะบัะธั ะธะทะฒะปะตัะตะฝะธั | ะัะฟะพะปัะทะพะฒะฐะฝะธะต | ะกัะฐััั |
|-----------|------|-----------|---------------|-------------------|---------------|--------|
| **CQC Ratings** | โ | โ (93-100%) | โ | โ ะััะผะพะน ะดะพัััะฟ | โ | โ **100%** |
| **Service User Bands** | โ | โ (24-76%) | โ | โ `get_service_user_band()` | โ | โ **85%** |
| **Regulated Activities** | โ | ๐ (0-2% โ 30-80%) | โ | โ `get_regulated_activity()` | โ | ๐ **ะ ะฟัะพัะตััะต** |
| **Location** | โ | โ (100%) | โ | โ ะััะผะพะน ะดะพัััะฟ | โ | โ **100%** |
| **Facilities** | โ | โ | โ (56-93%) | โ `get_amenity_value()` | โ | โ **100%** |
| **Funding** | โ | โ | โ (93-100%) | โ `get_funding_acceptance()` | โ๏ธ | โ **95%** |

---

**ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต:** 2025-12-20



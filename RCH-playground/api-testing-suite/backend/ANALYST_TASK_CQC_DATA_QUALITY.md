# –ó–∞–¥–∞—á–∞ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ CQC –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–î–∞—Ç–∞:** 2025-01-XX  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π  
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

---

## üìã –ö–æ–Ω—Ç–µ–∫—Å—Ç

–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (CQC + Staging) –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å—é –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö –ø–æ–ª–µ–π –≤ CQC –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (`cqc_carehomes_master_full_data_rows.csv`).

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è CQC –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã—è–≤–∏—Ç—å –ø—Ä–∏—á–∏–Ω—ã –Ω–∏–∑–∫–æ–π –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π.

**–í–∞–∂–Ω–æ:** –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è **–ï–°–¢–¨** –≤ CQC API. –ü—Ä–æ–±–ª–µ–º–∞ –≤ ETL –ø—Ä–æ—Ü–µ—Å—Å–µ - –¥–∞–Ω–Ω—ã–µ –∏–∑ API –Ω–µ –º–∞–ø–ø—è—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ CSV –ø–æ–ª—è.

---

## üîç –ó–∞–¥–∞—á–∞

### 1. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–ª–µ–π –≤ `cqc_carehomes_master_full_data_rows.csv`:

#### A. Service User Bands (12 –ø–æ–ª–µ–π) - **–ö–†–ò–¢–ò–ß–ù–û**

| –ü–æ–ª–µ | –û–∂–∏–¥–∞–µ–º–∞—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å | –¢–µ–∫—É—â–∞—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|------|------------------------|----------------------|--------|
| `service_user_band_older_people` | > 80% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `service_user_band_dementia` | > 50% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `service_user_band_mental_health` | > 30% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `service_user_band_physical_disability` | > 50% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `service_user_band_sensory_impairment` | > 30% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `service_user_band_children` | > 5% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `service_user_band_learning_disabilities` | > 20% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `service_user_band_detained_mental_health` | > 5% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `service_user_band_drugs_alcohol` | > 5% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `service_user_band_eating_disorder` | > 2% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `service_user_band_whole_population` | > 10% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `service_user_band_younger_adults` | > 10% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |

**–í–æ–ø—Ä–æ—Å—ã:**
- –ü–æ—á–µ–º—É –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—è –ø—É—Å—Ç—ã–µ (NULL –∏–ª–∏ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)?
- –ï—Å—Ç—å –ª–∏ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º CQC CSV (`cqc_carehomes_master_full_data_rows.csv`)?
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–∞–ø–ø–∏–Ω–≥ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ CQC CSV –≤ —Ñ–∏–Ω–∞–ª—å–Ω—É—é –±–∞–∑—É?
- ‚úÖ **–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û:** –ï—Å—Ç—å –ª–∏ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ CQC API? ‚Üí **–î–ê, –í–°–ï –ü–û–õ–Ø –ï–°–¢–¨** (—Å–º. `CQC_CRITICAL_FIELDS_API_MAPPING.md`)
- **–ö–†–ò–¢–ò–ß–ù–û:** –ï—Å—Ç—å –ª–∏ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ CQC API? (–°–º. `CQC_API_FIELD_MAPPING_ANALYSIS.md`)

---

#### B. Regulated Activities (7 –ø–æ–ª–µ–π) - **–ö–†–ò–¢–ò–ß–ù–û**

| –ü–æ–ª–µ | –û–∂–∏–¥–∞–µ–º–∞—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å | –¢–µ–∫—É—â–∞—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|------|------------------------|----------------------|--------|
| `service_type_care_home_nursing` | > 30% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `service_type_care_home_without_nursing` | > 60% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `regulated_activity_surgical` | > 5% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `regulated_activity_treatment` | > 10% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `regulated_activity_diagnostic` | > 5% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `regulated_activity_nursing_care` | > 0% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `regulated_activity_personal_care` | > 0% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |

**–í–æ–ø—Ä–æ—Å—ã:**
- ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ù–û:** –ü–æ—á–µ–º—É `regulated_activity_nursing_care` –≤—Å–µ–≥–¥–∞ –ø—É—Å—Ç–æ–µ (0.0%)?
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `service_type_care_home_nursing` –≤–º–µ—Å—Ç–æ `regulated_activity_nursing_care`?
- –ï—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º CQC CSV –¥–ª—è —ç—Ç–∏—Ö –ø–æ–ª–µ–π?
- ‚úÖ **–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û:** –ï—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ CQC API `regulatedActivities[]`? ‚Üí **–î–ê, –ï–°–¢–¨** (—Å–º. `CQC_CRITICAL_FIELDS_API_MAPPING.md`)
  - API –ø—É—Ç—å: `response.regulatedActivities[]`
  - –ü—Ä–æ–≤–µ—Ä–∫–∞: `name` —Å–æ–¥–µ—Ä–∂–∏—Ç "nursing care"
  - **–í—ã–≤–æ–¥:** –ü—Ä–æ–±–ª–µ–º–∞ –≤ ETL –ø—Ä–æ—Ü–µ—Å—Å–µ - –¥–∞–Ω–Ω—ã–µ –∏–∑ API –Ω–µ –º–∞–ø–ø—è—Ç—Å—è –≤ CSV

---

#### C. CQC Ratings (6 –ø–æ–ª–µ–π) - **–ö–†–ò–¢–ò–ß–ù–û**

| –ü–æ–ª–µ | –û–∂–∏–¥–∞–µ–º–∞—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å | –¢–µ–∫—É—â–∞—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|------|------------------------|----------------------|--------|
| `location_latest_overall_rating` | > 80% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `cqc_rating_safe` | > 80% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `cqc_rating_effective` | > 80% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `cqc_rating_caring` | > 80% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `cqc_rating_responsive` | > 80% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `cqc_rating_well_led` | > 80% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |

**–í–æ–ø—Ä–æ—Å—ã:**
- –ü–æ—á–µ–º—É –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ –ø—É—Å—Ç—ã–µ?
- –ï—Å—Ç—å –ª–∏ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º CQC CSV?
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–∞–ø–ø–∏–Ω–≥ –Ω–∞–∑–≤–∞–Ω–∏–π –ø–æ–ª–µ–π?

---

#### D. Location (5 –ø–æ–ª–µ–π) - **–ö–†–ò–¢–ò–ß–ù–û**

| –ü–æ–ª–µ | –û–∂–∏–¥–∞–µ–º–∞—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å | –¢–µ–∫—É—â–∞—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|------|------------------------|----------------------|--------|
| `location_latitude` | > 90% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `location_longitude` | > 90% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `location_postal_code` | > 95% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `location_city` | > 95% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `location_local_authority` | > 90% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |

**–í–æ–ø—Ä–æ—Å—ã:**
- –ü–æ—á–µ–º—É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º–∏?
- –ï—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º CQC CSV?
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ?

---

#### E. Inspection (3 –ø–æ–ª—è) - **–í–ê–ñ–ù–û**

| –ü–æ–ª–µ | –û–∂–∏–¥–∞–µ–º–∞—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å | –¢–µ–∫—É—â–∞—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|------|------------------------|----------------------|--------|
| `publication_date` | > 70% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `location_inspection_directorate` | > 80% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `location_primary_inspection_category` | > 80% | ? | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |

**–í–æ–ø—Ä–æ—Å—ã:**
- –ü–æ—á–µ–º—É –¥–∞—Ç—ã –∏–Ω—Å–ø–µ–∫—Ü–∏–π –º–æ–≥—É—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º–∏?
- –ï—Å—Ç—å –ª–∏ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º CQC CSV?

---

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

#### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π CQC CSV

**–§–∞–π–ª:** `cqc_carehomes_master_full_data_rows.csv`

**–í–æ–ø—Ä–æ—Å—ã:**
- –ö–∞–∫–∏–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –∏—Å—Ö–æ–¥–Ω–æ–º CSV?
- –ö–∞–∫–∞—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª–µ–π –≤ –∏—Å—Ö–æ–¥–Ω–æ–º CSV?
- –ï—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π?

#### –®–∞–≥ 1.5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CQC API (–ù–û–í–û–ï) ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

**–ú–µ—Ç–æ–¥:** `GET /locations/{locationId}` —á–µ—Ä–µ–∑ CQC API

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞:** ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è **–ï–°–¢–¨** –≤ CQC API

**–°–º. –ø–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑:** `CQC_CRITICAL_FIELDS_API_MAPPING.md`

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è API:**
- `regulatedActivities[]` ‚Üí –¥–ª—è `regulated_activity_*` –ø–æ–ª–µ–π ‚úÖ
- `gacServiceTypes[]` ‚Üí –¥–ª—è `service_user_band_*` –ø–æ–ª–µ–π ‚úÖ
- `specialisms[]` ‚Üí –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö `service_user_band_*` –ø–æ–ª–µ–π ‚úÖ
- `locationTypes[]` ‚Üí –¥–ª—è `service_type_*` –ø–æ–ª–µ–π ‚úÖ

**–í—ã–≤–æ–¥:** –ü—Ä–æ–±–ª–µ–º–∞ **–ù–ï** –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ API, –∞ –≤ **ETL –ø—Ä–æ—Ü–µ—Å—Å–µ** - –¥–∞–Ω–Ω—ã–µ –∏–∑ API –Ω–µ –º–∞–ø–ø—è—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ CSV –ø–æ–ª—è.

**SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```sql
-- –ü—Ä–∏–º–µ—Ä: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ Service User Bands
SELECT 
    COUNT(*) as total_rows,
    COUNT(service_user_band_older_people) as has_older_people,
    COUNT(service_user_band_dementia) as has_dementia,
    COUNT(service_user_band_mental_health) as has_mental_health,
    ROUND(100.0 * COUNT(service_user_band_older_people) / COUNT(*), 1) as older_people_pct,
    ROUND(100.0 * COUNT(service_user_band_dementia) / COUNT(*), 1) as dementia_pct,
    ROUND(100.0 * COUNT(service_user_band_mental_health) / COUNT(*), 1) as mental_health_pct
FROM cqc_carehomes_master_full_data_rows;
```

---

#### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ –∏–∑ CQC CSV –≤ —Ñ–∏–Ω–∞–ª—å–Ω—É—é –±–∞–∑—É

**–§–∞–π–ª—ã:**
- `RCH-data/input/mapping_improved_script.sql`
- `RCH-data/input/cqc-to-care_homes_grok.sql`

**–í–æ–ø—Ä–æ—Å—ã:**
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –º–∞–ø–ø—è—Ç—Å—è –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è?
- –ï—Å—Ç—å –ª–∏ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –º–∞–ø–ø–∏–Ω–≥–µ?
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è NULL –∑–Ω–∞—á–µ–Ω–∏—è?

**–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```sql
-- –°—Ä–∞–≤–Ω–∏—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–º CSV –∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –±–∞–∑–µ
SELECT 
    'Source CSV' as source,
    COUNT(*) as total,
    COUNT(service_user_band_older_people) as has_older_people
FROM cqc_carehomes_master_full_data_rows
UNION ALL
SELECT 
    'Final DB' as source,
    COUNT(*) as total,
    COUNT(serves_older_people) as has_older_people
FROM care_homes;
```

---

#### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ETL –ø—Ä–æ—Ü–µ—Å—Å

**–í–æ–ø—Ä–æ—Å—ã:**
- –ï—Å—Ç—å –ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö?
- –ï—Å—Ç—å –ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π?
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è?

---

### 3. –í—ã—è–≤–∏—Ç—å –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º

#### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

1. **–î–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –∏—Å—Ö–æ–¥–Ω–æ–º CQC CSV** ‚ö†Ô∏è **–í–ï–†–û–Ø–¢–ù–û**
   - –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CQC API –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
   - **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –°—Ä–∞–≤–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ CSV —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ CQC API

2. **–û—à–∏–±–∫–∏ –≤ –º–∞–ø–ø–∏–Ω–≥–µ** ‚ö†Ô∏è **–í–ï–†–û–Ø–¢–ù–û**
   - –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø—Ä–∞–≤–∏—Ç—å SQL —Å–∫—Ä–∏–ø—Ç—ã –º–∞–ø–ø–∏–Ω–≥–∞
   - –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–∞–ø–ø–∏–Ω–≥–∞
   - **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –°–º. `CQC_API_FIELD_MAPPING_ANALYSIS.md` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–∞–ø–ø–∏–Ω–≥–∞

3. **–ü–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ ETL** ‚ö†Ô∏è **–í–ï–†–û–Ø–¢–ù–û**
   - –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
   - **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –°—Ä–∞–≤–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –¥–æ –∏ –ø–æ—Å–ª–µ ETL

4. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ NULL**
   - –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å COALESCE –¥–ª—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   - –†–µ—à–µ–Ω–∏–µ: –†–∞–∑–ª–∏—á–∞—Ç—å NULL (–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ) –∏ FALSE (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ)

5. **–î–∞–Ω–Ω—ã–µ –µ—Å—Ç—å –≤ API, –Ω–æ –Ω–µ –º–∞–ø–ø—è—Ç—Å—è –≤ CSV** ‚úÖ **–ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û**
   - **–ü—Ä–∏—á–∏–Ω–∞:** ETL –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ CQC API
   - **–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–∏—Ç—å ETL –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ API
   - **–°–º. –º–∞–ø–ø–∏–Ω–≥:** `CQC_API_FIELD_MAPPING_ANALYSIS.md`

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –û—Ç—á–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:

1. **–¢–∞–±–ª–∏—Ü—É –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π:**
   - –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è
   - –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–º CQC CSV (%)
   - –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –±–∞–∑–µ (%)
   - –†–∞–∑–Ω–∏—Ü–∞ (–ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö)
   - –°—Ç–∞—Ç—É—Å (OK / LOW / CRITICAL)

2. **–°–ø–∏—Å–æ–∫ –ø—Ä–æ–±–ª–µ–º:**
   - –ü–æ–ª—è —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å—é < 10% (CRITICAL)
   - –ü–æ–ª—è —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å—é 10-50% (LOW)
   - –ü–æ–ª—è —Å –ø–æ—Ç–µ—Ä—è–º–∏ –¥–∞–Ω–Ω—ã—Ö > 5% –ø—Ä–∏ –º–∞–ø–ø–∏–Ω–≥–µ

3. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
   - –ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –º–∞–ø–ø–∏–Ω–≥–µ
   - –ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ ETL –ø—Ä–æ—Ü–µ—Å—Å–µ
   - –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–∑ CQC API
   - **–ö–†–ò–¢–ò–ß–ù–û:** –ú–∞–ø–ø–∏–Ω–≥ –∏–∑ CQC API –≤ CSV –ø–æ–ª—è (—Å–º. `CQC_API_FIELD_MAPPING_ANALYSIS.md`)

4. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å CQC API:**
   - –ö–∞–∫–∏–µ –ø–æ–ª—è –µ—Å—Ç—å –≤ API, –Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ CSV
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –º–∞–ø–ø–∏–Ω–≥–∞ API ‚Üí CSV
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é API –¥–∞–Ω–Ω—ã—Ö

---

## üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### Python —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:

```python
import csv
from collections import defaultdict

def analyze_cqc_data_quality(csv_file: str):
    """
    –ê–Ω–∞–ª–∏–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª–µ–π –≤ CQC CSV.
    """
    with open(csv_file, 'r', encoding='utf-8') as f:
        reader = csv.DictReader(f)
        headers = list(reader.fieldnames)
        rows = list(reader)
    
    total_rows = len(rows)
    results = {}
    
    critical_fields = [
        'service_user_band_older_people',
        'service_user_band_dementia',
        # ... –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è
    ]
    
    for field in critical_fields:
        if field not in headers:
            results[field] = {'status': 'MISSING', 'filled': 0, 'percentage': 0.0}
            continue
        
        filled = sum(1 for row in rows 
                    if row.get(field, '').strip() 
                    and row.get(field, '').upper() not in ['NULL', 'NONE', '', 'FALSE', '0'])
        
        percentage = (filled / total_rows) * 100
        results[field] = {
            'status': 'OK' if percentage >= 50 else 'LOW' if percentage >= 10 else 'CRITICAL',
            'filled': filled,
            'empty': total_rows - filled,
            'percentage': percentage
        }
    
    return results
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

1. ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
2. ‚úÖ –í—ã—è–≤–ª–µ–Ω—ã –ø—Ä–∏—á–∏–Ω—ã –Ω–∏–∑–∫–æ–π –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏
3. ‚úÖ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω—ã —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º
4. ‚úÖ –°–æ–∑–¥–∞–Ω –æ—Ç—á–µ—Ç —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

---

## üìÖ –°—Ä–æ–∫–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π  
**–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 2-3 –¥–Ω—è

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–í–æ–ø—Ä–æ—Å—ã –ø–æ –∑–∞–¥–∞—á–µ:** –û–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É  
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- `HYBRID_DATABASE_MATCHING_ANALYSIS.md` - –û–±—â–∏–π –∞–Ω–∞–ª–∏–∑ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞
- `CQC_API_FIELD_MAPPING_ANALYSIS.md` - **–ö–†–ò–¢–ò–ß–ù–û:** –ú–∞–ø–ø–∏–Ω–≥ CQC API ‚Üí CSV –ø–æ–ª—è

---

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –û–ñ–ò–î–ê–ï–¢ –í–´–ü–û–õ–ù–ï–ù–ò–Ø


# ๐ ะะพะปะฝัะน ะฐะฝะฐะปะธะท ะธัะฟัะฐะฒะปะตะฝะธั CQC ะฑะฐะทั ะดะฐะฝะฝัั

**ะะฐัะฐ:** 2025-12-20  
**ะกัะฐััั:** โ ะะะะะะ ะะะะะะจะะ

---

## ๐ฏ ะัะฟะพะปะฝะตะฝะฝัะต ะธัะฟัะฐะฒะปะตะฝะธั

### **1. CQC Overall Rating** โ

**ะัะพะฑะปะตะผะฐ:**
- ะคัะฝะบัะธั `extract_ratings_from_api` ะฒะพะทะฒัะฐัะฐะปะฐ ัะปะพะฒะฐัั ะฒะผะตััะพ ัััะพะบะธ
- 80% ะดะฐะฝะฝัั ัะฟััะตะฝะพ

**ะะตัะตะฝะธะต:**
- โ ะัะฟัะฐะฒะปะตะฝะฐ ััะฝะบัะธั ะดะปั ะธะทะฒะปะตัะตะฝะธั ัััะพะบะธ `rating` ะธะท ัะปะพะฒะฐัั
- โ ะะพะฑะฐะฒะปะตะฝะพ ะธะทะฒะปะตัะตะฝะธะต ะธะท `keyQuestionRatings` ะดะปั ะดััะณะธั ัะตะนัะธะฝะณะพะฒ
- โ ะัะฟัะฐะฒะปะตะฝะฐ ััะฝะบัะธั ัะพััะฐะฝะตะฝะธั ะฒ CSV

**ะกัะฐััั:** โ ะะกะะะะะะะะ

---

### **2. Regulated Activities** ๐

**ะัะพะฑะปะตะผะฐ:**
- `regulated_activity_nursing_care`: 0.0% (ะฒัะตะณะดะฐ `FALSE`)
- `regulated_activity_personal_care`: 2.0% (ะฟะพััะธ ะฒัะตะณะดะฐ `FALSE`)
- ะะฐะฝะฝัะต ะตััั ะฒ API, ะฝะพ ะฝะต ะธะทะฒะปะตะบะฐะปะธัั

**ะะตัะตะฝะธะต:**
- โ ะกะพะทะดะฐะฝะฐ ััะฝะบัะธั `extract_regulated_activities_from_api`
- โ ะะพะฑะฐะฒะปะตะฝะฐ ะปะพะณะธะบะฐ ะพะฑะฝะพะฒะปะตะฝะธั ะฒ `update_home_from_api`
- โ ะะพะฑะฐะฒะปะตะฝั ะฟะพะปั ะฒ `UPDATABLE_FIELDS`
- โ ะะพะฑะฐะฒะปะตะฝ ะผะฐะฟะฟะธะฝะณ ะฒ `save_homes_to_csv`

**ะกัะฐััั:** ๐ ะะะะะะะฏะะขะกะฏ (ะฟัะพัะตัั ะฒัะฟะพะปะฝัะตััั)

**ะะถะธะดะฐะตะผัะต ัะตะทัะปััะฐัั:**
- `regulated_activity_nursing_care`: ~30% (~4,377 ะดะพะผะพะฒ)
- `regulated_activity_personal_care`: ~70-80% (~10,000-11,500 ะดะพะผะพะฒ)

---

### **3. Service User Bands** โ

**ะัะพะฑะปะตะผะฐ:**
- ะคัะฝะบัะธั `extract_service_user_bands_from_api` ะธัะฟะพะปัะทะพะฒะฐะปะฐ ัะพัะฝะพะต ัะพะฒะฟะฐะดะตะฝะธะต
- API ะฒะพะทะฒัะฐัะฐะตั ัะฟะตัะธะฐะปัะฝัะต ะฝะฐะทะฒะฐะฝะธั ัะธะฟะฐ "Caring for adults over 65 yrs"

**ะะตัะตะฝะธะต:**
- โ ะฃะปัััะตะฝะฐ ััะฝะบัะธั ะดะปั ะฟะพะธัะบะฐ ะฟะพ ะบะปััะตะฒัะผ ัะปะพะฒะฐะผ
- โ ะะพะฑะฐะฒะปะตะฝะฐ ะฟะพะดะดะตัะถะบะฐ ัะฐะทะปะธัะฝัั ัะพัะผะฐัะพะฒ ะฝะฐะทะฒะฐะฝะธะน

**ะกัะฐััั:** โ ะะกะะะะะะะะ

---

## ๐ ะะฝะฐะปะธะท ะฟะพะปะตะน ะดะปั ะผะฐััะธะฝะณะฐ

### **ะะฑัะฐั ััะฐัะธััะธะบะฐ:**

| ะะฐัะตะณะพัะธั | ะะพะปะธัะตััะฒะพ | ะัะพัะตะฝั |
|-----------|------------|---------|
| โ **ะะพะปั ะฟัะธัััััะฒััั** | 22/32 | 68.8% |
| โ **ะะพะปั ะพััััััะฒััั** | 10/32 | 31.2% |
| ๐ข **ะััะพะบะฐั ะทะฐะฟะพะปะฝะตะฝะฝะพััั (>50%)** | 14 | 43.8% |
| ๐ก **ะกัะตะดะฝัั ะทะฐะฟะพะปะฝะตะฝะฝะพััั (10-50%)** | 5 | 15.6% |
| ๐ด **ะะธะทะบะฐั ะทะฐะฟะพะปะฝะตะฝะฝะพััั (<10%)** | 13 | 40.6% |

---

## ๐ ะะฝะฐะปะธะท Facilities

### **ะ ััะตะผะต ะะ:**
- โ ะะปะพัะบะธะต ะฟะพะปั: `wheelchair_access`, `ensuite_rooms`, `secure_garden`, `wifi_available`, `parking_onsite`
- โ JSONB ะฟะพะปะต: `facilities`

### **ะ CQC CSV:**
- โ ะััััััะฒััั

### **ะ Staging CSV:**
- โ **ะะกะขะฌ** ั ัะพัะพัะตะน ะทะฐะฟะพะปะฝะตะฝะฝะพัััั:
  - `parsed_wheelchair_access`: 93.0%
  - `parsed_parking_onsite`: 56.5%
  - `parsed_wifi_available`: 68.9%
  - `parsed_ensuite_rooms`: 12.0%
  - `parsed_secure_garden`: 2.1%

### **ะคัะฝะบัะธั ะธะทะฒะปะตัะตะฝะธั:**
- โ `get_amenity_value()` - ัะฐะฑะพัะฐะตั ะฟัะธ ะทะฐะณััะทะบะต ะธะท ะะ ะธะปะธ ะณะธะฑัะธะดะฝะพะผ ะฟะพะดัะพะดะต

### **ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะผะฐััะธะฝะณะต:**
- โ ะัะฟะพะปัะทัะตััั ะฒ `_calculate_location()` ะธ `_calculate_lifestyle()`

**ะกัะฐััั:** โ **ะะะะะขะะะข** ัะตัะตะท ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด

---

## ๐ ะะฝะฐะปะธะท Funding

### **ะ ััะตะผะต ะะ:**
- โ ะะปะพัะบะธะต ะฟะพะปั: `accepts_self_funding`, `accepts_local_authority`, `accepts_nhs_chc`, `accepts_third_party_topup`

### **ะ CQC CSV:**
- โ ะััััััะฒััั

### **ะ Staging CSV:**
- โ **ะะกะขะฌ** ั ะพัะปะธัะฝะพะน ะทะฐะฟะพะปะฝะตะฝะฝะพัััั:
  - `parsed_accepts_self_funding`: 93.6%
  - `parsed_accepts_local_authority`: 100.0%
  - `parsed_accepts_nhs_chc`: 92.5%
  - `parsed_accepts_third_party_topup`: 0.3%

### **ะคัะฝะบัะธั ะธะทะฒะปะตัะตะฝะธั:**
- โ `get_funding_acceptance()` - ัะฐะฑะพัะฐะตั ะฟัะธ ะทะฐะณััะทะบะต ะธะท ะะ ะธะปะธ ะณะธะฑัะธะดะฝะพะผ ะฟะพะดัะพะดะต

### **ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะผะฐััะธะฝะณะต:**
- โ๏ธ ะะต ะธัะฟะพะปัะทัะตััั ะฝะฐะฟััะผัั (ะผะพะถะตั ะฑััั ะดะพะฑะฐะฒะปะตะฝะพ)

**ะกัะฐััั:** โ **ะะะะะขะะะข** ัะตัะตะท ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด

---

## ๐ ะัะพะณะพะฒะฐั ัะฐะฑะปะธัะฐ ะณะพัะพะฒะฝะพััะธ

| ะะฐัะตะณะพัะธั | ะะปะพัะบะธะต ะฟะพะปั ะฒ ะะ | JSONB ะฟะพะปะต ะฒ ะะ | ะ CQC CSV | ะ Staging CSV | ะคัะฝะบัะธั ะธะทะฒะปะตัะตะฝะธั | ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะผะฐััะธะฝะณะต | ะกัะฐััั |
|-----------|-------------------|-----------------|-----------|---------------|-------------------|-------------------------|--------|
| **CQC Ratings** | โ ะััั (6 ะฟะพะปะตะน) | โ ะะตั | โ ะััั (93-100%) | โ ะะตั | โ ะััะผะพะน ะดะพัััะฟ | โ ะัะฟะพะปัะทัะตััั | โ **100%** |
| **Service User Bands** | โ ะััั (12 ะฟะพะปะตะน) | โ `service_user_bands` | โ ะััั (24-76%) | โ ะะตั | โ `get_service_user_band()` | โ ะัะฟะพะปัะทัะตััั | โ **85%** |
| **Regulated Activities** | โ ะััั (5 ะฟะพะปะตะน) | โ `regulated_activities` | ๐ ะะฑะฝะพะฒะปัะตััั | โ ะะตั | โ `get_regulated_activity()` | โ ะัะฟะพะปัะทัะตััั | ๐ **ะ ะฟัะพัะตััะต** |
| **Location** | โ ะััั (5 ะฟะพะปะตะน) | โ ะะตั | โ ะััั (100%) | โ ะะตั | โ ะััะผะพะน ะดะพัััะฟ | โ ะัะฟะพะปัะทัะตััั | โ **100%** |
| **Facilities** | โ ะััั (5 ะฟะพะปะตะน) | โ `facilities` | โ ะะตั | โ ะััั (56-93%) | โ `get_amenity_value()` | โ ะัะฟะพะปัะทัะตััั | โ **100%** |
| **Funding** | โ ะััั (4 ะฟะพะปั) | โ ะะตั | โ ะะตั | โ ะััั (93-100%) | โ `get_funding_acceptance()` | โ๏ธ ะะต ะธัะฟะพะปัะทัะตััั | โ **95%** |

---

## ๐ฏ ะัะพะณะพะฒะฐั ะพัะตะฝะบะฐ ะณะพัะพะฒะฝะพััะธ

### **ะะพัะพะฒะฝะพััั CQC ะฑะฐะทั ะดะฐะฝะฝัั ะดะปั ะผะฐััะธะฝะณะฐ:** ๐ข **90%**

**ะะฑะพัะฝะพะฒะฐะฝะธะต:**

#### **โ ะกะธะปัะฝัะต ััะพัะพะฝั:**

1. **CQC Ratings:** 100% ะทะฐะฟะพะปะฝะตะฝะฝะพััั - ะพัะปะธัะฝะพ
2. **Location:** 100% ะทะฐะฟะพะปะฝะตะฝะฝะพััั - ะพัะปะธัะฝะพ
3. **Service User Bands:** ะฅะพัะพัะฐั ะทะฐะฟะพะปะฝะตะฝะฝะพััั (24-76%) - ัะพัะพัะพ
4. **Care Types:** ะัะธัััััะฒััั ะธ ะทะฐะฟะพะปะฝะตะฝั - ัะพัะพัะพ
5. **Facilities:** ะะพัััะฟะฝั ัะตัะตะท Staging ะฑะฐะทั (56-93%) - ัะพัะพัะพ
6. **Funding:** ะะพัััะฟะฝั ัะตัะตะท Staging ะฑะฐะทั (93-100%) - ัะพัะพัะพ

#### **โ๏ธ ะขัะตะฑัะตั ะฒะฝะธะผะฐะฝะธั:**

1. **Regulated Activities:** ะะฑะฝะพะฒะปัะตััั ัะตัะตะท API (ะฒ ะฟัะพัะตััะต)
2. **Facilities ะฒ CQC CSV:** ะััััััะฒััั, ะฝะพ ะดะพัััะฟะฝั ัะตัะตะท Staging
3. **Funding ะฒ CQC CSV:** ะััััััะฒััั, ะฝะพ ะดะพัััะฟะฝั ัะตัะตะท Staging

#### **โ ะะตัะตะฝะธั:**

1. **ะัะฟะพะปัะทะพะฒะฐัั ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด:**
   - `get_care_homes_hybrid()` ะดะปั ะทะฐะณััะทะบะธ CQC + Staging
   - ะะฑะตัะฟะตัะธะฒะฐะตั ะดะพัััะฟ ะบ Facilities ะธ Funding

2. **ะัะฟะพะปัะทะพะฒะฐัั ะฑะฐะทั ะดะฐะฝะฝัั ะฝะฐะฟััะผัั:**
   - `AsyncDataLoader` ะดะปั ะทะฐะณััะทะบะธ ะธะท ะะ
   - ะะฑะตัะฟะตัะธะฒะฐะตั ะดะพัััะฟ ะบ JSONB ะฟะพะปัะผ

---

## ๐ ะะตะบะพะผะตะฝะดะฐัะธะธ

### **ะัะธะพัะธัะตั 1: ะะฐะฒะตััะธัั ะพะฑะฝะพะฒะปะตะฝะธะต Regulated Activities** ๐

**ะกัะฐััั:** ะ ะฟัะพัะตััะต

**ะะตะนััะฒะธะต:** ะะพะถะดะฐัััั ะทะฐะฒะตััะตะฝะธั ะฟัะพัะตััะฐ ะพะฑะฝะพะฒะปะตะฝะธั

---

### **ะัะธะพัะธัะตั 2: ะัะฟะพะปัะทะพะฒะฐัั ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด** โ

**ะะตะนััะฒะธะต:**
- ะัะฟะพะปัะทะพะฒะฐัั `get_care_homes_hybrid()` ะดะปั ะทะฐะณััะทะบะธ ะดะฐะฝะฝัั
- ะญัะพ ะพะฑะตัะฟะตัะธั ะดะพัััะฟ ะบ Facilities ะธ Funding ะธะท Staging ะฑะฐะทั

**ะกัะฐััั:** โ ะฃะถะต ัะตะฐะปะธะทะพะฒะฐะฝะพ

---

### **ะัะธะพัะธัะตั 3: ะัะพะฒะตัะธัั ะผะฐะฟะฟะธะฝะณ Staging โ ะะ** โ๏ธ

**ะะตะนััะฒะธะต:**
- ะฃะฑะตะดะธัััั, ััะพ `staging_data_loader.py` ะฟัะฐะฒะธะปัะฝะพ ะผะฐะฟะฟะธั ะฟะพะปั:
  - `parsed_wheelchair_access` โ `wheelchair_access`
  - `parsed_accepts_local_authority` โ `accepts_local_authority`
  - ะ ั.ะด.

**ะกัะฐััั:** โ๏ธ ะขัะตะฑัะตั ะฟัะพะฒะตัะบะธ

---

## โ ะัะฒะพะดั

### **ะงัะพ ัะฐะฑะพัะฐะตั ัะพัะพัะพ:**

1. โ **CQC Ratings:** 100% ะทะฐะฟะพะปะฝะตะฝะฝะพััั
2. โ **Location:** 100% ะทะฐะฟะพะปะฝะตะฝะฝะพััั
3. โ **Service User Bands:** ะฅะพัะพัะฐั ะทะฐะฟะพะปะฝะตะฝะฝะพััั (24-76%)
4. โ **Care Types:** ะัะธัััััะฒััั ะธ ะทะฐะฟะพะปะฝะตะฝั
5. โ **Facilities:** ะะพัััะฟะฝั ัะตัะตะท Staging ะฑะฐะทั (56-93%)
6. โ **Funding:** ะะพัััะฟะฝั ัะตัะตะท Staging ะฑะฐะทั (93-100%)

### **ะงัะพ ััะตะฑัะตั ะฒะฝะธะผะฐะฝะธั:**

1. โ๏ธ **Regulated Activities:** ะะฑะฝะพะฒะปัะตััั ัะตัะตะท API (ะฒ ะฟัะพัะตััะต)
2. โ **Facilities:** ะะพัััะฟะฝั ัะตัะตะท ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด
3. โ **Funding:** ะะพัััะฟะฝั ัะตัะตะท ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด

---

## ๐ฏ ะคะธะฝะฐะปัะฝัะน ะฒัะฒะพะด

**ะะฐะทะฐ ะดะฐะฝะฝัั ะณะพัะพะฒะฐ ะดะปั ะผะฐััะธะฝะณะฐ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ:**

1. โ **CQC ะฑะฐะทะฐ** - ะดะปั ะบัะธัะธัะตัะบะธั ะฟะพะปะตะน (Service User Bands, CQC Ratings, Location)
2. โ **Staging ะฑะฐะทะฐ** - ะดะปั Facilities ะธ Funding (ัะตัะตะท ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด)
3. โ **JSONB ะฟะพะปั** - ะดะปั ะดะพะฟะพะปะฝะธัะตะปัะฝัั ะดะฐะฝะฝัั (ะฟัะธ ะทะฐะณััะทะบะต ะธะท ะะ)
4. ๐ **API ะพะฑะฝะพะฒะปะตะฝะธั** - ะดะปั Regulated Activities (ะฒ ะฟัะพัะตััะต)

**ะะตะบะพะผะตะฝะดะฐัะธั:** โ ะัะฟะพะปัะทะพะฒะฐัั ะณะธะฑัะธะดะฝัะน ะฟะพะดัะพะด (`get_care_homes_hybrid()`) ะดะปั ะผะฐะบัะธะผะฐะปัะฝะพะณะพ ะฟะพะบัััะธั ะดะฐะฝะฝัั.

**ะะพัะพะฒะฝะพััั:** ๐ข **90%** (ะฟะพัะปะต ะทะฐะฒะตััะตะฝะธั ะพะฑะฝะพะฒะปะตะฝะธั Regulated Activities ะฑัะดะตั **95%**)

---

**ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต:** 2025-12-20



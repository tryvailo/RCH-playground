# üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ Facilities –∏ Funding JSONB –ø–æ–ª–µ–π

**–î–∞—Ç–∞:** 2025-12-20  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### **JSONB –ø–æ–ª—è –≤ —Å—Ö–µ–º–µ –ë–î:**

–ò–∑ `care_homes_db_v2_2_PRODUCTION_FINAL.sql`:

```sql
-- –ì–†–£–ü–ü–ê 15: JSONB –ü–û–õ–Ø (17 –ø–æ–ª–µ–π)
regulated_activities JSONB DEFAULT '{"activities": []}'::jsonb,
facilities JSONB DEFAULT '{}'::jsonb,
staff_information JSONB DEFAULT '{}'::jsonb,
service_user_bands JSONB DEFAULT '[]'::jsonb,
...
```

**–í—ã–≤–æ–¥:** ‚úÖ JSONB –ø–æ–ª—è **–ï–°–¢–¨** –≤ —Å—Ö–µ–º–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

---

## üîç –ê–Ω–∞–ª–∏–∑ Facilities

### **–ü–ª–æ—Å–∫–∏–µ –ø–æ–ª—è –≤ –ë–î:**

–ò–∑ —Å—Ö–µ–º—ã –ë–î (—Å—Ç—Ä–æ–∫–∏ 135-141):
```sql
wheelchair_access BOOLEAN DEFAULT FALSE,
ensuite_rooms BOOLEAN DEFAULT FALSE,
secure_garden BOOLEAN DEFAULT FALSE,
wifi_available BOOLEAN DEFAULT FALSE,
parking_onsite BOOLEAN DEFAULT FALSE,
```

**–í—ã–≤–æ–¥:** ‚úÖ –ü–ª–æ—Å–∫–∏–µ –ø–æ–ª—è **–ï–°–¢–¨** –≤ —Å—Ö–µ–º–µ –ë–î.

### **JSONB –ø–æ–ª–µ `facilities`:**

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ (–∏–∑ –∫–æ–¥–∞):**
```json
{
  "facilities": {
    "general_amenities": ["parking", "wheelchair_access", "secure_garden", "wifi"],
    "parking_onsite": true,
    "wheelchair_access": true,
    "ensuite_rooms": false,
    "secure_garden": true,
    "wifi_available": true,
    "medical_equipment": ["oxygen", "hospital_bed", "hoist"],
    "on_site_pharmacy": false
  }
}
```

### **–§—É–Ω–∫—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è:**

**`get_amenity_value(home, amenity_name)`** –∏–∑ `db_field_extractor.py`:

**–õ–æ–≥–∏–∫–∞:**
1. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–ª–æ—Å–∫–æ–µ –ø–æ–ª–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `parking_onsite`)
2. ‚úÖ –ï—Å–ª–∏ `NULL`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç JSONB `facilities` ‚Üí `general_amenities` (–º–∞—Å—Å–∏–≤)
3. ‚úÖ –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç JSONB `facilities` ‚Üí `amenity_name` (–ø—Ä—è–º–æ–π –∫–ª—é—á)
4. ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `True`/`False`/`None`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `simple_matching_service.py`

---

## üîç –ê–Ω–∞–ª–∏–∑ Funding

### **–ü–ª–æ—Å–∫–∏–µ –ø–æ–ª—è –≤ –ë–î:**

–ò–∑ —Å—Ö–µ–º—ã –ë–î (–ø—Ä–æ–≤–µ—Ä–∫–∞):
```sql
-- –ù–ï –ù–ê–ô–î–ï–ù–û –≤ —Å—Ö–µ–º–µ –ë–î!
-- –ù–µ—Ç –ø–æ–ª–µ–π: accepts_local_authority_funding, accepts_private_funding, accepts_nhs_funding
```

**–í—ã–≤–æ–¥:** ‚ùå –ü–ª–æ—Å–∫–∏–µ –ø–æ–ª—è –¥–ª—è funding **–û–¢–°–£–¢–°–¢–í–£–Æ–¢** –≤ —Å—Ö–µ–º–µ –ë–î.

### **JSONB –ø–æ–ª–µ –¥–ª—è Funding:**

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã –ë–î:**
- ‚ùå –ù–µ—Ç –ø–æ–ª—è `funding` –∏–ª–∏ `funding_acceptance` –≤ JSONB –ø–æ–ª—è—Ö
- ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–æ–µ –ø–æ–ª–µ –∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### **–§—É–Ω–∫—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è:**

**`get_funding_acceptance(home, funding_type)`** –∏–∑ `db_field_extractor.py`:

**–õ–æ–≥–∏–∫–∞:**
1. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–ª–æ—Å–∫–∏–µ –ø–æ–ª—è:
   - `accepts_self_funding`
   - `accepts_local_authority`
   - `accepts_nhs_chc`
   - `accepts_third_party_topup`
2. ‚ùå **–ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç JSONB** (–Ω–µ—Ç –ª–æ–≥–∏–∫–∏ –¥–ª—è JSONB `funding`)

**–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–ª–æ—Å–∫–∏–µ –ø–æ–ª—è, –∫–æ—Ç–æ—Ä—ã—Ö **–ù–ï–¢** –≤ —Å—Ö–µ–º–µ –ë–î!

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞

### **Funding –ø–æ–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç:**

1. ‚ùå **–í —Å—Ö–µ–º–µ –ë–î:** –ù–µ—Ç –ø–ª–æ—Å–∫–∏—Ö –ø–æ–ª–µ–π `accepts_*_funding`
2. ‚ùå **–í —Å—Ö–µ–º–µ –ë–î:** –ù–µ—Ç JSONB –ø–æ–ª—è `funding` –∏–ª–∏ `funding_acceptance`
3. ‚ùå **–í CSV:** –ù–µ—Ç –ø–æ–ª–µ–π funding
4. ‚ö†Ô∏è **–í –∫–æ–¥–µ:** –§—É–Ω–∫—Ü–∏—è `get_funding_acceptance()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è

**–í—ã–≤–æ–¥:** Funding –¥–∞–Ω–Ω—ã–µ **–ù–ï –î–û–°–¢–£–ü–ù–´** –Ω–∏ –≤ –ë–î, –Ω–∏ –≤ CSV, –Ω–∏ —á–µ—Ä–µ–∑ JSONB.

---

## ‚úÖ –†–µ—à–µ–Ω–∏—è

### **–†–µ—à–µ–Ω–∏–µ 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Staging –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** ‚úÖ

**–ü–æ–¥—Ö–æ–¥:**
- Staging –±–∞–∑–∞ (`carehome_staging_export.csv`) –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å funding –¥–∞–Ω–Ω—ã–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥: CQC + Staging
- –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `hybrid_data_merger.py`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –≥–∏–±—Ä–∏–¥–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ

**–î–µ–π—Å—Ç–≤–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ Staging –±–∞–∑–∞ funding –¥–∞–Ω–Ω—ã–µ

---

### **–†–µ—à–µ–Ω–∏–µ 2: –û–±–æ–≥–∞—Ç–∏—Ç—å —á–µ—Ä–µ–∑ API** ‚ö†Ô∏è

**–ü–æ–¥—Ö–æ–¥:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è funding –¥–∞–Ω–Ω—ã—Ö
- –û–±–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å —ç—Ç–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

### **–†–µ—à–µ–Ω–∏–µ 3: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –≤ –ë–î** ‚ö†Ô∏è

**–ü–æ–¥—Ö–æ–¥:**
- –î–æ–±–∞–≤–∏—Ç—å –ø–ª–æ—Å–∫–∏–µ –ø–æ–ª—è `accepts_*_funding` –≤ —Å—Ö–µ–º—É –ë–î
- –ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å JSONB –ø–æ–ª–µ `funding_acceptance`

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ü–ª–æ—Å–∫–∏–µ –ø–æ–ª—è –≤ –ë–î | JSONB –ø–æ–ª–µ –≤ –ë–î | –í CSV | –§—É–Ω–∫—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è | –°—Ç–∞—Ç—É—Å |
|-----------|-------------------|-----------------|-------|-------------------|--------|
| **Facilities** | ‚úÖ –ï—Å—Ç—å (5 –ø–æ–ª–µ–π) | ‚úÖ `facilities` | ‚ùå –ù–µ—Ç | ‚úÖ `get_amenity_value()` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –ë–î |
| **Funding** | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ö†Ô∏è `get_funding_acceptance()` | ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç |

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Staging –±–∞–∑—É** ‚ö†Ô∏è

**–î–µ–π—Å—Ç–≤–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ `carehome_staging_export.csv` funding –¥–∞–Ω–Ω—ã–µ
- –ï—Å–ª–∏ –¥–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥

---

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –û–±–Ω–æ–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `get_funding_acceptance()`** ‚ö†Ô∏è

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
- –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É JSONB –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

**–î–µ–π—Å—Ç–≤–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É JSONB `funding_acceptance` (–µ—Å–ª–∏ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ)
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Staging –±–∞–∑—ã

---

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –î–æ–±–∞–≤–∏—Ç—å Funding –≤ –ë–î** ‚ö†Ô∏è

**–î–µ–π—Å—Ç–≤–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å JSONB –ø–æ–ª–µ `funding_acceptance` –≤ —Å—Ö–µ–º—É –ë–î
- –ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–ª–æ—Å–∫–∏–µ –ø–æ–ª—è `accepts_*_funding`

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

---

## ‚úÖ –í—ã–≤–æ–¥—ã

### **Facilities:**

1. ‚úÖ **–ü–ª–æ—Å–∫–∏–µ –ø–æ–ª—è –ï–°–¢–¨** –≤ —Å—Ö–µ–º–µ –ë–î
2. ‚úÖ **JSONB –ø–æ–ª–µ –ï–°–¢–¨** –≤ —Å—Ö–µ–º–µ –ë–î
3. ‚ùå **–ù–ï —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ CSV**
4. ‚úÖ **–§—É–Ω–∫—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç** (–ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑ –ë–î)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ facilities –¥–∞–Ω–Ω—ã–º.

---

### **Funding:**

1. ‚ùå **–ü–ª–æ—Å–∫–∏–µ –ø–æ–ª—è –û–¢–°–£–¢–°–¢–í–£–Æ–¢** –≤ —Å—Ö–µ–º–µ –ë–î
2. ‚ùå **JSONB –ø–æ–ª–µ –û–¢–°–£–¢–°–¢–í–£–ï–¢** –≤ —Å—Ö–µ–º–µ –ë–î
3. ‚ùå **–ù–ï —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ CSV**
4. ‚ö†Ô∏è **–§—É–Ω–∫—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Staging –±–∞–∑—É –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å funding –ø–æ–ª—è –≤ –ë–î.

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-12-20


